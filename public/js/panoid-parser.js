var $addList, $autosearch, $form, $status, API_KEY, FPS, SUFFIX, VERSION, bLinkUpdate, bThrough, clear, cntMarker, exportJson, json, list, load, map, markerList, onLinksChanged, prevDate, prevId, service, setPano, settings, storage, svp, undo, updateSettings, updateStatus, urlReg;

API_KEY = "AIzaSyBQ2dzDfyF8Y0Dwe-Q6Jzx4_G62ANrTotQ";

VERSION = '0.1';

SUFFIX = 'pip';

FPS = 24.0;

storage = localStorage;

settings = {};

map = null;

svp = null;

urlReg = /!1s(.*)!2e/;

list = [];

$status = null;

$autosearch = null;

$addList = null;

$form = null;

prevId = '';

cntMarker = null;

bLinkUpdate = false;

bThrough = false;

prevDate = null;

service = new google.maps.StreetViewService();

markerList = [];

updateSettings = function() {
  return $form.find('input, textarea').each(function() {
    var type;
    type = $(this).attr('type');
    if (type === 'checkbox' || type === 'radio') {
      return settings[this.name] = $(this).is(':checked');
    } else {
      return settings[this.name] = $(this).val();
    }
  });
};

$(function() {
  var options;
  $form = $('#panoid-parser');
  $status = $('#status');
  $autosearch = $('[name=autosearch');
  $addList = $('[name=addlist]');
  $('#laod').on('click', load);
  $('#clear').on('click', clear);
  $('#undo').on('click', undo);
  $('#set-pano').on('click', setPano);
  $('#export').on('click', exportJson);
  $('input, textarea').on('change', updateSettings);
  $form.sisyphus();
  options = {
    zoom: 16,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };
  map = new google.maps.Map($('#map')[0], options);
  options = {
    enableCloseButton: false,
    imageDateControl: true
  };
  svp = new google.maps.StreetViewPanorama($('#svp')[0], options);
  cntMarker = new google.maps.Marker({
    map: map,
    icon: 'http://www.googlemapsmarkers.com/v1/009900'
  });
  return google.maps.event.addListener(svp, 'links_changed', onLinksChanged);
});

json = "";

undo = function() {
  if (list.length <= 1) {
    alert("cannot undo anymore");
    return;
  }
  markerList[markerList.length - 1].setMap(null);
  markerList.pop();
  list.pop();
  prevId = list.length >= 2 ? list[list.length - 2] : "";
  bThrough = true;
  svp.setPano(list[list.length - 1]);
  return updateSettings();
};

clear = function() {
  var i, len, m;
  console.log("clear");
  list.length = 0;
  for (i = 0, len = markerList.length; i < len; i++) {
    m = markerList[i];
    console.log(m);
    m.setMap(null);
  }
  markerList.length = 0;
  prevId = '';
  return updateStatus();
};

exportJson = function() {
  console.log("export");
  json = JSON.stringify(list);
  return $('#json').val(json);
};

load = function() {
  var panoId, result;
  updateSettings();
  result = urlReg.exec(settings.url);
  if (result != null) {
    panoId = result[1];
  } else {
    panoId = settings.url;
  }
  return svp.setPano(panoId);
};

updateStatus = function() {
  return $status.html("count: " + list.length + "<br>duration: " + ((list.length / FPS).toPrecision(2)));
};

setPano = function() {
  var newPano;
  newPano = map.getStreetView().getPano();
  return svp.setPano(newPano);
};

onLinksChanged = function() {
  var id, l, links, pos;
  links = svp.getLinks();
  if (!bLinkUpdate) {
    links = (function() {
      var i, len, results;
      results = [];
      for (i = 0, len = links.length; i < len; i++) {
        l = links[i];
        if (l.pano !== prevId) {
          results.push(l);
        }
      }
      return results;
    })();
    bLinkUpdate = true;
    svp.setLinks(links);
    return;
  }
  bLinkUpdate = false;
  pos = svp.getPosition();
  id = svp.getPano();
  if (bThrough) {
    map.setCenter(pos);
    cntMarker.setPosition(pos);
    bThrough = false;
    return;
  }
  return service.getPanoramaById(id, (function(_this) {
    return function(data, status) {
      var date, marker, nextId;
      if (status !== google.maps.StreetViewStatus.OK) {
        alert('cannot retrive pano id');
        return;
      }
      date = data.imageDate;
      if ((prevDate != null) && date !== prevDate) {
        $('#console').append("date changed: " + prevDate + " -> " + date);
      }
      prevDate = date;
      map.setCenter(pos);
      cntMarker.setPosition(pos);
      if ($addList.prop('checked')) {
        list.push(id);
        marker = new google.maps.Marker({
          position: pos,
          map: map,
          title: "" + (list.length - 1)
        });
        markerList.push(marker);
        updateStatus();
      }
      nextId = void 0;
      if ($autosearch.prop('checked')) {
        if (links.length === 1) {
          nextId = links[0].pano;
        }
      }
      prevId = svp.getPano();
      if (nextId != null) {
        return setTimeout(function() {
          return svp.setPano(nextId);
        }, 50);
      }
    };
  })(this));
};

//# sourceMappingURL=data:application/json;base64,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QTtBQUFBLE1BZUEsU0FBUyxDQUFDLFdBQVYsQ0FBdUIsR0FBdkIsQ0FmQSxDQUFBO0FBa0JBLE1BQUEsSUFBRyxRQUFRLENBQUMsSUFBVCxDQUFjLFNBQWQsQ0FBSDtBQUVDLFFBQUEsSUFBSSxDQUFDLElBQUwsQ0FBVyxFQUFYLENBQUEsQ0FBQTtBQUFBLFFBRUEsTUFBQSxHQUFhLElBQUEsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFaLENBQ1o7QUFBQSxVQUFBLFFBQUEsRUFBVSxHQUFWO0FBQUEsVUFDQSxHQUFBLEVBQUssR0FETDtBQUFBLFVBRUEsS0FBQSxFQUFPLEVBQUEsR0FBRSxDQUFDLElBQUksQ0FBQyxNQUFMLEdBQWMsQ0FBZixDQUZUO1NBRFksQ0FGYixDQUFBO0FBQUEsUUFPQSxVQUFVLENBQUMsSUFBWCxDQUFpQixNQUFqQixDQVBBLENBQUE7QUFBQSxRQVNBLFlBQUEsQ0FBQSxDQVRBLENBRkQ7T0FsQkE7QUFBQSxNQWdDQSxNQUFBLEdBQVMsTUFoQ1QsQ0FBQTtBQWtDQSxNQUFBLElBQUcsV0FBVyxDQUFDLElBQVosQ0FBaUIsU0FBakIsQ0FBSDtBQUNDLFFBQUEsSUFBRyxLQUFLLENBQUMsTUFBTixLQUFnQixDQUFuQjtBQUNDLFVBQUEsTUFBQSxHQUFTLEtBQU0sQ0FBQSxDQUFBLENBQUUsQ0FBQyxJQUFsQixDQUREO1NBREQ7T0FsQ0E7QUFBQSxNQXNDQSxNQUFBLEdBQVMsR0FBRyxDQUFDLE9BQUosQ0FBQSxDQXRDVCxDQUFBO0FBd0NBLE1BQUEsSUFBRyxjQUFIO2VBQ0MsVUFBQSxDQUFXLFNBQUEsR0FBQTtpQkFDVixHQUFHLENBQUMsT0FBSixDQUFhLE1BQWIsRUFEVTtRQUFBLENBQVgsRUFFRSxFQUZGLEVBREQ7T0ExQzJCO0lBQUEsRUFBQTtFQUFBLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBNUIsRUF0QmdCO0FBQUEsQ0FqSmpCLENBQUEiLCJmaWxlIjoicGFub2lkLXBhcnNlci5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyIsInNvdXJjZXNDb250ZW50IjpbIkFQSV9LRVkgPSBcIkFJemFTeUJRMmR6RGZ5RjhZMER3ZS1RNkp6eDRfRzYyQU5yVG90UVwiXG5WRVJTSU9OID0gJzAuMSdcblNVRkZJWCA9ICdwaXAnXG5GUFMgPSAyNC4wXG5cblxuc3RvcmFnZSA9IGxvY2FsU3RvcmFnZVxuXG5zZXR0aW5ncyA9IHt9XG5cbm1hcCA9IG51bGxcbnN2cCA9IG51bGxcblxudXJsUmVnID0gLyExcyguKikhMmUvXG5cbmxpc3QgPSBbXVxuXG4jIGpxXG4kc3RhdHVzID0gbnVsbFxuJGF1dG9zZWFyY2ggPSBudWxsXG4kYWRkTGlzdCA9IG51bGxcbiRmb3JtID0gbnVsbFxuXG5wcmV2SWQgPSAnJ1xuXG5jbnRNYXJrZXIgPSBudWxsXG5cbmJMaW5rVXBkYXRlID0gZmFsc2VcbmJUaHJvdWdoID0gZmFsc2VcblxucHJldkRhdGUgPSBudWxsXG5cbnNlcnZpY2UgPSBuZXcgZ29vZ2xlLm1hcHMuU3RyZWV0Vmlld1NlcnZpY2UoKVxuXG5tYXJrZXJMaXN0ID0gW11cblxuXG4jLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4jIGZ1bmNcblxudXBkYXRlU2V0dGluZ3MgPSAtPlxuXHQkZm9ybS5maW5kKCdpbnB1dCwgdGV4dGFyZWEnKS5lYWNoIC0+XG5cdFx0dHlwZSA9ICQodGhpcykuYXR0cigndHlwZScpXG5cdFx0aWYgdHlwZSA9PSAnY2hlY2tib3gnIHx8IHR5cGUgPT0gJ3JhZGlvJ1xuXHRcdFx0c2V0dGluZ3NbdGhpcy5uYW1lXSA9ICQodGhpcykuaXMoJzpjaGVja2VkJylcblx0XHRlbHNlXG5cdFx0XHRzZXR0aW5nc1t0aGlzLm5hbWVdID0gJCh0aGlzKS52YWwoKVxuXG4jLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4jIGluaXRcblxuJCAtPlxuXHQkZm9ybSA9ICQoJyNwYW5vaWQtcGFyc2VyJylcblx0JHN0YXR1cyA9ICQoJyNzdGF0dXMnKVxuXHQkYXV0b3NlYXJjaCA9ICQoJ1tuYW1lPWF1dG9zZWFyY2gnKVxuXHQkYWRkTGlzdCA9ICQoJ1tuYW1lPWFkZGxpc3RdJylcblxuXHQkKCcjbGFvZCcpLm9uICdjbGljaycsIGxvYWRcblx0JCgnI2NsZWFyJykub24gJ2NsaWNrJywgY2xlYXJcblx0JCgnI3VuZG8nKS5vbiAnY2xpY2snLCB1bmRvXG5cdCQoJyNzZXQtcGFubycpLm9uICdjbGljaycsIHNldFBhbm9cblx0JCgnI2V4cG9ydCcpLm9uICdjbGljaycsIGV4cG9ydEpzb25cblxuXHQkKCdpbnB1dCwgdGV4dGFyZWEnKS5vbiAnY2hhbmdlJywgdXBkYXRlU2V0dGluZ3NcblxuXHQkZm9ybS5zaXN5cGh1cygpXG5cblx0b3B0aW9ucyA9IFxuXHRcdHpvb206IDE2XG5cdFx0bWFwVHlwZUlkOiBnb29nbGUubWFwcy5NYXBUeXBlSWQuUk9BRE1BUFxuXG5cdG1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoICQoJyNtYXAnKVswXSwgb3B0aW9ucylcblxuXHRvcHRpb25zID1cblx0XHRlbmFibGVDbG9zZUJ1dHRvbjogZmFsc2Vcblx0XHRpbWFnZURhdGVDb250cm9sOiB0cnVlXG5cblx0c3ZwID0gbmV3IGdvb2dsZS5tYXBzLlN0cmVldFZpZXdQYW5vcmFtYSggJCgnI3N2cCcpWzBdLCBvcHRpb25zIClcblxuXHRjbnRNYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyXG5cdFx0bWFwOiBtYXBcblx0XHRpY29uOiAnaHR0cDovL3d3dy5nb29nbGVtYXBzbWFya2Vycy5jb20vdjEvMDA5OTAwJ1xuXG5cdGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKHN2cCwgJ2xpbmtzX2NoYW5nZWQnLCBvbkxpbmtzQ2hhbmdlZClcblxuIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuIyBhY3Rpb25cblxuanNvbiA9IFwiXCIgXG5cbnVuZG8gPSAtPlxuXHRpZiBsaXN0Lmxlbmd0aCA8PSAxXG5cdFx0YWxlcnQoXCJjYW5ub3QgdW5kbyBhbnltb3JlXCIpXG5cdFx0cmV0dXJuXG5cblx0bWFya2VyTGlzdFttYXJrZXJMaXN0Lmxlbmd0aC0xXS5zZXRNYXAobnVsbClcblx0bWFya2VyTGlzdC5wb3AoKVxuXHRsaXN0LnBvcCgpXG5cdFxuXHRwcmV2SWQgPSBpZiBsaXN0Lmxlbmd0aCA+PSAyIHRoZW4gbGlzdFtsaXN0Lmxlbmd0aC0yXSBlbHNlIFwiXCJcblxuXHRiVGhyb3VnaCA9IHRydWVcblx0c3ZwLnNldFBhbm8oIGxpc3RbbGlzdC5sZW5ndGgtMV0gKVxuXG5cdHVwZGF0ZVNldHRpbmdzKClcblxuY2xlYXIgPSAtPlxuXHRjb25zb2xlLmxvZyBcImNsZWFyXCJcblx0bGlzdC5sZW5ndGggPSAwXG5cdGZvciBtIGluIG1hcmtlckxpc3Rcblx0XHRjb25zb2xlLmxvZyBtXG5cdFx0bS5zZXRNYXAobnVsbClcblx0bWFya2VyTGlzdC5sZW5ndGggPSAwXG5cdHByZXZJZCA9ICcnXG5cdHVwZGF0ZVN0YXR1cygpXG5cbmV4cG9ydEpzb24gPSAtPlxuXHRjb25zb2xlLmxvZyBcImV4cG9ydFwiXG5cdGpzb24gPSBKU09OLnN0cmluZ2lmeSggbGlzdCApXG5cdCQoJyNqc29uJykudmFsKCBqc29uIClcblxuXG5sb2FkID0gLT5cblx0dXBkYXRlU2V0dGluZ3MoKVxuXG5cdHJlc3VsdCA9IHVybFJlZy5leGVjKCBzZXR0aW5ncy51cmwgKVxuXG5cdGlmIHJlc3VsdD9cblx0XHRwYW5vSWQgPSByZXN1bHRbMV1cblx0ZWxzZVxuXHRcdHBhbm9JZCA9IHNldHRpbmdzLnVybFxuXG5cdHN2cC5zZXRQYW5vKCBwYW5vSWQgKVxuXG5cbnVwZGF0ZVN0YXR1cyA9IC0+XG5cdCRzdGF0dXMuaHRtbChcImNvdW50OiAje2xpc3QubGVuZ3RofTxicj5kdXJhdGlvbjogI3sobGlzdC5sZW5ndGggLyBGUFMpLnRvUHJlY2lzaW9uKDIpfVwiKVxuXG5zZXRQYW5vID0gLT5cblx0bmV3UGFubyA9IG1hcC5nZXRTdHJlZXRWaWV3KCkuZ2V0UGFubygpXG5cdHN2cC5zZXRQYW5vKCBuZXdQYW5vIClcblxuIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuIyBldnRcblxub25MaW5rc0NoYW5nZWQgPSAtPlxuXG5cdGxpbmtzID0gc3ZwLmdldExpbmtzKClcblxuXHQjIHNldCBsaW5rc1xuXHRpZiBub3QgYkxpbmtVcGRhdGVcblx0XHRsaW5rcyA9IChsIGZvciBsIGluIGxpbmtzIHdoZW4gbC5wYW5vICE9IHByZXZJZClcblx0XHRiTGlua1VwZGF0ZSA9IHRydWVcblx0XHRzdnAuc2V0TGlua3MoIGxpbmtzIClcblx0XHRyZXR1cm5cblxuXHRiTGlua1VwZGF0ZSA9IGZhbHNlXG5cblx0cG9zID0gc3ZwLmdldFBvc2l0aW9uKClcblx0aWQgPSBzdnAuZ2V0UGFubygpXG5cblx0aWYgYlRocm91Z2hcblx0XHRtYXAuc2V0Q2VudGVyKCBwb3MgKVxuXHRcdGNudE1hcmtlci5zZXRQb3NpdGlvbiggcG9zIClcblx0XHRiVGhyb3VnaCA9IGZhbHNlXG5cdFx0cmV0dXJuXG5cdFx0XG5cdHNlcnZpY2UuZ2V0UGFub3JhbWFCeUlkIGlkLCAoZGF0YSwgc3RhdHVzKSA9PlxuXG5cdFx0aWYgc3RhdHVzICE9IGdvb2dsZS5tYXBzLlN0cmVldFZpZXdTdGF0dXMuT0sgXG5cdFx0XHRhbGVydCgnY2Fubm90IHJldHJpdmUgcGFubyBpZCcpXG5cdFx0XHRyZXR1cm5cblxuXHRcdCMgY2hlY2sgaWYgZGF0ZSBpcyBjb3JyZWN0XG5cdFx0ZGF0ZSA9IGRhdGEuaW1hZ2VEYXRlXG5cdFx0aWYgcHJldkRhdGU/ICYmIGRhdGUgIT0gcHJldkRhdGVcblx0XHRcdCMgaWYgIWNvbmZpcm0oJ2ltYWdlRGF0ZSBjaGFuZ2VkLiBjb250aW51ZT8nKVxuXHRcdFx0IyBcdHByZXZEYXRlID0gZGF0ZVxuXHRcdFx0IyBcdHN2cC5zZXRQYW5vKHByZXZJZClcblx0XHRcdCMgXHRyZXR1cm5cblx0XHRcdCQoJyNjb25zb2xlJykuYXBwZW5kKFwiZGF0ZSBjaGFuZ2VkOiAje3ByZXZEYXRlfSAtPiAje2RhdGV9XCIpXG5cdFx0cHJldkRhdGUgPSBkYXRlXG5cblx0XHRtYXAuc2V0Q2VudGVyKCBwb3MgKVxuXHRcdGNudE1hcmtlci5zZXRQb3NpdGlvbiggcG9zIClcblxuXHRcdCMgYWRkIG1hcmtlclxuXHRcdGlmICRhZGRMaXN0LnByb3AoJ2NoZWNrZWQnKVxuXG5cdFx0XHRsaXN0LnB1c2goIGlkIClcblxuXHRcdFx0bWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlclxuXHRcdFx0XHRwb3NpdGlvbjogcG9zXG5cdFx0XHRcdG1hcDogbWFwXG5cdFx0XHRcdHRpdGxlOiBcIiN7bGlzdC5sZW5ndGggLSAxfVwiXG5cblx0XHRcdG1hcmtlckxpc3QucHVzaCggbWFya2VyIClcblxuXHRcdFx0dXBkYXRlU3RhdHVzKClcblxuXHRcdCMgYXV0b3NlcmFjaFxuXHRcdG5leHRJZCA9IHVuZGVmaW5lZFxuXG5cdFx0aWYgJGF1dG9zZWFyY2gucHJvcCgnY2hlY2tlZCcpXG5cdFx0XHRpZiBsaW5rcy5sZW5ndGggPT0gMVxuXHRcdFx0XHRuZXh0SWQgPSBsaW5rc1swXS5wYW5vXG5cblx0XHRwcmV2SWQgPSBzdnAuZ2V0UGFubygpXG5cblx0XHRpZiBuZXh0SWQ/XG5cdFx0XHRzZXRUaW1lb3V0IC0+XG5cdFx0XHRcdHN2cC5zZXRQYW5vKCBuZXh0SWQgKVxuXHRcdFx0LCA1MFxuXG5cbiJdfQ==