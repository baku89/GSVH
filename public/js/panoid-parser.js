var $addList, $autosearch, $form, $status, API_KEY, FPS, SUFFIX, VERSION, bLinkUpdate, clear, cntMarker, exportJson, list, load, map, onLinksChanged, prevDate, prevId, service, settings, storage, svp, updateSettings, updateStatus, urlReg;

API_KEY = "AIzaSyBQ2dzDfyF8Y0Dwe-Q6Jzx4_G62ANrTotQ";

VERSION = '0.1';

SUFFIX = 'pip';

FPS = 24.0;

storage = localStorage;

settings = {};

map = null;

svp = null;

urlReg = /!1s(.*)!2e/;

list = [];

$status = null;

$autosearch = null;

$addList = null;

$form = null;

prevId = '';

cntMarker = null;

bLinkUpdate = false;

prevDate = null;

service = new google.maps.StreetViewService();

updateSettings = function() {
  return $form.find('input, textarea').each(function() {
    var type;
    type = $(this).attr('type');
    console.log(type);
    if (type === 'checkbox' || type === 'radio') {
      return settings[this.name] = $(this).is(':checked');
    } else {
      return settings[this.name] = $(this).val();
    }
  });
};

$(function() {
  var options;
  $form = $('#panoid-parser');
  $status = $('#status');
  $autosearch = $('[name=autosearch');
  $addList = $('[name=addlist]');
  $('#laod').on('click', load);
  $('#clear').on('click', clear);
  $('#export').on('click', exportJson);
  $('input, textarea').on('change', updateSettings);
  $form.sisyphus();
  options = {
    zoom: 16,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  };
  map = new google.maps.Map($('#map')[0], options);
  options = {
    enableCloseButton: false,
    imageDateControl: true
  };
  svp = new google.maps.StreetViewPanorama($('#svp')[0], options);
  cntMarker = new google.maps.Marker({
    map: map,
    icon: 'http://www.googlemapsmarkers.com/v1/009900'
  });
  return google.maps.event.addListener(svp, 'links_changed', onLinksChanged);
});

clear = function() {
  list = [];
  prevId = '';
  return updateStatus();
};

exportJson = function() {
  var json;
  json = JSON.stringify(list);
  return $('#json').html(json);
};

load = function() {
  var panoId, result;
  updateSettings();
  result = urlReg.exec(settings.url);
  panoId = result[1];
  return svp.setPano(panoId);
};

updateStatus = function() {
  return $status.html("count: " + list.length + "<br>duration: " + ((list.length / FPS).toPrecision(2)));
};

onLinksChanged = function() {
  var id, l, links, pos;
  links = svp.getLinks();
  if (!bLinkUpdate) {
    links = (function() {
      var i, len, results;
      results = [];
      for (i = 0, len = links.length; i < len; i++) {
        l = links[i];
        if (l.pano !== prevId) {
          results.push(l);
        }
      }
      return results;
    })();
    bLinkUpdate = true;
    svp.setLinks(links);
    return;
  }
  bLinkUpdate = false;
  pos = svp.getPosition();
  id = svp.getPano();
  return service.getPanoramaById(id, (function(_this) {
    return function(data, status) {
      var date, marker, nextId;
      if (status !== google.maps.StreetViewStatus.OK) {
        alert('cannot retrive pano id');
        return;
      }
      date = data.imageDate;
      console.log(date);
      if ((prevDate != null) && date !== prevDate) {
        if (!confirm('imageDate changed. continue?')) {
          prevDate = date;
          return;
        }
      }
      prevDate = date;
      map.setCenter(pos);
      cntMarker.setPosition(pos);
      if ($addList.prop('checked')) {
        list.push(id);
        marker = new google.maps.Marker({
          position: pos,
          map: map,
          title: "" + (list.length - 1)
        });
        updateStatus();
      }
      nextId = void 0;
      if ($autosearch.prop('checked')) {
        if (links.length === 1) {
          nextId = links[0].pano;
        }
      }
      prevId = svp.getPano();
      if (nextId != null) {
        return svp.setPano(nextId);
      }
    };
  })(this));
};

//# sourceMappingURL=data:application/json;base64,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LENBQUMsTUFBTixLQUFnQixDQUFuQjtBQUNDLFVBQUEsTUFBQSxHQUFTLEtBQU0sQ0FBQSxDQUFBLENBQUUsQ0FBQyxJQUFsQixDQUREO1NBREQ7T0FqQ0E7QUFBQSxNQXFDQSxNQUFBLEdBQVMsR0FBRyxDQUFDLE9BQUosQ0FBQSxDQXJDVCxDQUFBO0FBdUNBLE1BQUEsSUFBRyxjQUFIO2VBQ0MsR0FBRyxDQUFDLE9BQUosQ0FBYSxNQUFiLEVBREQ7T0F6QzJCO0lBQUEsRUFBQTtFQUFBLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBNUIsRUFoQmdCO0FBQUEsQ0E3R2pCLENBQUEiLCJmaWxlIjoicGFub2lkLXBhcnNlci5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyIsInNvdXJjZXNDb250ZW50IjpbIkFQSV9LRVkgPSBcIkFJemFTeUJRMmR6RGZ5RjhZMER3ZS1RNkp6eDRfRzYyQU5yVG90UVwiXG5WRVJTSU9OID0gJzAuMSdcblNVRkZJWCA9ICdwaXAnXG5GUFMgPSAyNC4wXG5cblxuc3RvcmFnZSA9IGxvY2FsU3RvcmFnZVxuXG5zZXR0aW5ncyA9IHt9XG5cbm1hcCA9IG51bGxcbnN2cCA9IG51bGxcblxudXJsUmVnID0gLyExcyguKikhMmUvXG5cbmxpc3QgPSBbXVxuXG4jIGpxXG4kc3RhdHVzID0gbnVsbFxuJGF1dG9zZWFyY2ggPSBudWxsXG4kYWRkTGlzdCA9IG51bGxcbiRmb3JtID0gbnVsbFxuXG5wcmV2SWQgPSAnJ1xuXG5jbnRNYXJrZXIgPSBudWxsXG5cbmJMaW5rVXBkYXRlID0gZmFsc2VcblxucHJldkRhdGUgPSBudWxsXG5cbnNlcnZpY2UgPSBuZXcgZ29vZ2xlLm1hcHMuU3RyZWV0Vmlld1NlcnZpY2UoKVxuXG5cbiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiMgZnVuY1xuXG51cGRhdGVTZXR0aW5ncyA9IC0+XG5cdCRmb3JtLmZpbmQoJ2lucHV0LCB0ZXh0YXJlYScpLmVhY2ggLT5cblx0XHR0eXBlID0gJCh0aGlzKS5hdHRyKCd0eXBlJylcblx0XHRjb25zb2xlLmxvZyB0eXBlXG5cdFx0aWYgdHlwZSA9PSAnY2hlY2tib3gnIHx8IHR5cGUgPT0gJ3JhZGlvJ1xuXHRcdFx0c2V0dGluZ3NbdGhpcy5uYW1lXSA9ICQodGhpcykuaXMoJzpjaGVja2VkJylcblx0XHRlbHNlXG5cdFx0XHRzZXR0aW5nc1t0aGlzLm5hbWVdID0gJCh0aGlzKS52YWwoKVxuXG4jLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4jIGluaXRcblxuJCAtPlxuXHQkZm9ybSA9ICQoJyNwYW5vaWQtcGFyc2VyJylcblx0JHN0YXR1cyA9ICQoJyNzdGF0dXMnKVxuXHQkYXV0b3NlYXJjaCA9ICQoJ1tuYW1lPWF1dG9zZWFyY2gnKVxuXHQkYWRkTGlzdCA9ICQoJ1tuYW1lPWFkZGxpc3RdJylcblxuXHQkKCcjbGFvZCcpLm9uICdjbGljaycsIGxvYWRcblx0JCgnI2NsZWFyJykub24gJ2NsaWNrJywgY2xlYXJcblx0JCgnI2V4cG9ydCcpLm9uICdjbGljaycsIGV4cG9ydEpzb25cblx0JCgnaW5wdXQsIHRleHRhcmVhJykub24gJ2NoYW5nZScsIHVwZGF0ZVNldHRpbmdzXG5cblx0JGZvcm0uc2lzeXBodXMoKVxuXG5cdG9wdGlvbnMgPSBcblx0XHR6b29tOiAxNlxuXHRcdG1hcFR5cGVJZDogZ29vZ2xlLm1hcHMuTWFwVHlwZUlkLlJPQURNQVBcblxuXHRtYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKCAkKCcjbWFwJylbMF0sIG9wdGlvbnMpXG5cblx0b3B0aW9ucyA9XG5cdFx0ZW5hYmxlQ2xvc2VCdXR0b246IGZhbHNlXG5cdFx0aW1hZ2VEYXRlQ29udHJvbDogdHJ1ZVxuXG5cdHN2cCA9IG5ldyBnb29nbGUubWFwcy5TdHJlZXRWaWV3UGFub3JhbWEoICQoJyNzdnAnKVswXSwgb3B0aW9ucyApXG5cblx0Y250TWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlclxuXHRcdG1hcDogbWFwXG5cdFx0aWNvbjogJ2h0dHA6Ly93d3cuZ29vZ2xlbWFwc21hcmtlcnMuY29tL3YxLzAwOTkwMCdcblxuXHRnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihzdnAsICdsaW5rc19jaGFuZ2VkJywgb25MaW5rc0NoYW5nZWQpXG5cbiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiMgYWN0aW9uXG5cbmNsZWFyID0gLT5cblx0bGlzdCA9IFtdXG5cdHByZXZJZCA9ICcnXG5cdHVwZGF0ZVN0YXR1cygpXG5cbmV4cG9ydEpzb24gPSAtPlxuXHRqc29uID0gSlNPTi5zdHJpbmdpZnkoIGxpc3QgKVxuXHQkKCcjanNvbicpLmh0bWwoIGpzb24gKVxuXG5cbmxvYWQgPSAtPlxuXHR1cGRhdGVTZXR0aW5ncygpXG5cblx0cmVzdWx0ID0gdXJsUmVnLmV4ZWMoIHNldHRpbmdzLnVybCApXG5cdHBhbm9JZCA9IHJlc3VsdFsxXVxuXHRcblx0c3ZwLnNldFBhbm8oIHBhbm9JZCApXG5cblxudXBkYXRlU3RhdHVzID0gLT5cblx0JHN0YXR1cy5odG1sKFwiY291bnQ6ICN7bGlzdC5sZW5ndGh9PGJyPmR1cmF0aW9uOiAjeyhsaXN0Lmxlbmd0aCAvIEZQUykudG9QcmVjaXNpb24oMil9XCIpXG5cblxuIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuIyBldnRcblxub25MaW5rc0NoYW5nZWQgPSAtPlxuXG5cdGxpbmtzID0gc3ZwLmdldExpbmtzKClcblxuXHQjIHNldCBsaW5rc1xuXHRpZiBub3QgYkxpbmtVcGRhdGVcblx0XHRsaW5rcyA9IChsIGZvciBsIGluIGxpbmtzIHdoZW4gbC5wYW5vICE9IHByZXZJZClcblx0XHRiTGlua1VwZGF0ZSA9IHRydWVcblx0XHRzdnAuc2V0TGlua3MoIGxpbmtzIClcblx0XHRyZXR1cm5cblxuXHRiTGlua1VwZGF0ZSA9IGZhbHNlXG5cblx0cG9zID0gc3ZwLmdldFBvc2l0aW9uKClcblx0aWQgPSBzdnAuZ2V0UGFubygpXG5cblx0c2VydmljZS5nZXRQYW5vcmFtYUJ5SWQgaWQsIChkYXRhLCBzdGF0dXMpID0+XG5cblx0XHRpZiBzdGF0dXMgIT0gZ29vZ2xlLm1hcHMuU3RyZWV0Vmlld1N0YXR1cy5PSyBcblx0XHRcdGFsZXJ0KCdjYW5ub3QgcmV0cml2ZSBwYW5vIGlkJylcblx0XHRcdHJldHVyblxuXG5cdFx0ZGF0ZSA9IGRhdGEuaW1hZ2VEYXRlXG5cblx0XHRjb25zb2xlLmxvZyBkYXRlXG5cblx0XHRpZiBwcmV2RGF0ZT8gJiYgZGF0ZSAhPSBwcmV2RGF0ZVxuXHRcdFx0aWYgIWNvbmZpcm0oJ2ltYWdlRGF0ZSBjaGFuZ2VkLiBjb250aW51ZT8nKVxuXHRcdFx0XHRwcmV2RGF0ZSA9IGRhdGVcblx0XHRcdFx0cmV0dXJuXG5cblx0XHRwcmV2RGF0ZSA9IGRhdGVcblxuXHRcdG1hcC5zZXRDZW50ZXIoIHBvcyApXG5cdFx0Y250TWFya2VyLnNldFBvc2l0aW9uKCBwb3MgKVxuXG5cdFx0IyBhZGQgbWFya2VyXG5cdFx0aWYgJGFkZExpc3QucHJvcCgnY2hlY2tlZCcpXG5cblx0XHRcdGxpc3QucHVzaCggaWQgKVxuXG5cdFx0XHRtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyXG5cdFx0XHRcdHBvc2l0aW9uOiBwb3Ncblx0XHRcdFx0bWFwOiBtYXBcblx0XHRcdFx0dGl0bGU6IFwiI3tsaXN0Lmxlbmd0aCAtIDF9XCJcblxuXHRcdFx0dXBkYXRlU3RhdHVzKClcblxuXHRcdCMgYXV0b3NlcmFjaFxuXHRcdG5leHRJZCA9IHVuZGVmaW5lZFxuXG5cdFx0aWYgJGF1dG9zZWFyY2gucHJvcCgnY2hlY2tlZCcpXG5cdFx0XHRpZiBsaW5rcy5sZW5ndGggPT0gMVxuXHRcdFx0XHRuZXh0SWQgPSBsaW5rc1swXS5wYW5vXG5cblx0XHRwcmV2SWQgPSBzdnAuZ2V0UGFubygpXG5cblx0XHRpZiBuZXh0SWQ/XG5cdFx0XHRzdnAuc2V0UGFubyggbmV4dElkIClcblxuXG4iXX0=