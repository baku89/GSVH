var GSVHyperlapse, getFollowedPath, pointOnLine,
  slice = [].slice;

Number.prototype.toRad = function() {
  return this * Math.PI / 180;
};

Number.prototype.toDeg = function() {
  return this * 180 / Math.PI;
};

pointOnLine = function(t, a, b) {
  var lat1, lat2, lng1, lng2, x, y;
  lat1 = a.lat().toRad();
  lng1 = a.lng().toRad();
  lat2 = b.lat().toRad();
  lng2 = b.lng().toRad();
  x = lat1 + t * (lat2 - lat1);
  y = lng1 + t * (lng2 - lng1);
  return new google.maps.LatLng(x.toDeg(), y.toDeg());
};

getFollowedPath = function(m, a, b) {
  var d, t;
  d = google.maps.geometry.spherical.computeDistanceBetween(a, b);
  if (m < 0 || d < m) {
    alert("error getFolowedPath");
  }
  t = m / d;
  return pointOnLine(t, a, b);
};

GSVHyperlapse = (function() {
  var _class;

  GSVHyperlapse.API_KEY = "AIzaSyBQ2dzDfyF8Y0Dwe-Q6Jzx4_G62ANrTotQ";

  GSVHyperlapse.DIST_BETWEEN_PTS = 5;

  GSVHyperlapse.MAX_PTS = 100;

  GSVHyperlapse.dirService = new google.maps.DirectionsService({});

  GSVHyperlapse.dirRegex = /dir\/([0-9.-]*),([0-9.-]*)\/([0-9.-]*),([0-9.-]*)\/@([0-9.-]*),([0-9.-]*),([0-9]*)z\/data=(.*)$/;

  GSVHyperlapse.dataRegex = /!1d([0-9.-]*)!2d([0-9.-]*)/g;

  GSVHyperlapse.dataLatLngRegex = /!1d([0-9.-]*)!2d([0-9.-]*)/;

  GSVHyperlapse.ldr = new GSVPANO.PanoLoader();

  GSVHyperlapse.ldrStack = [];

  _class = GSVHyperlapse;

  GSVHyperlapse.onError = function(err) {
    return alert("error");
  };

  GSVHyperlapse.onMessage = function() {
    return null;
  };

  GSVHyperlapse.onPanoramaLoad = function() {
    return null;
  };

  function GSVHyperlapse(args) {
    this.url = args.url;
    this.name = args.name;
    this.step = parseFloat(args.step);
    this.quality = args.quality;
    this.bCancel = false;
  }

  GSVHyperlapse.prototype.trace = function() {
    var args;
    args = 1 <= arguments.length ? slice.call(arguments, 0) : [];
    return console.log.apply(console, ["[" + this.name + "]"].concat(slice.call(args)));
  };

  GSVHyperlapse.prototype.traceBold = function(str) {
    return console.log("%c[" + this.name + "] " + str + " --------------------", "color:orange;font-weight:bold;");
  };

  GSVHyperlapse.prototype.create = function() {
    var _self, data, i, m, r, req, result, wp;
    this.traceBold("create");
    result = _class.dirRegex.exec(this.url);
    if (result == null) {
      alert("unco");
      _class.onMessage.call(this, "cannot parse url");
      return;
    }
    this.origin = new google.maps.LatLng(result[1], result[2]);
    this.destination = new google.maps.LatLng(result[3], result[4]);
    this.centroid = new google.maps.LatLng(result[5], result[6]);
    this.zoom = result[7];
    this.trace("origin: " + this.origin, "destination: " + this.destination);
    req = {
      origin: this.origin,
      destination: this.destination,
      travelMode: google.maps.DirectionsTravelMode.WALKING
    };
    this.waypoints = [];
    data = result[8];
    result = data.match(GSVHyperlapse.dataRegex);
    if (result != null) {
      for (i in result) {
        r = result[i];
        m = GSVHyperlapse.dataLatLngRegex.exec(r);
        wp = new google.maps.LatLng(m[2], m[1]);
        this.waypoints.push({
          location: wp.toString(),
          stopover: false
        });
      }
      this.trace("num of waypoints:", this.waypoints.length);
      req.waypoints = this.waypoints;
    }
    this.trace("request:", req);
    _self = this;
    return GSVHyperlapse.dirService.route(req, function(res, status) {
      if (status === google.maps.DirectionsStatus.OK) {
        return _self.analyze(res);
      } else {
        return _class.onMessage.call(this, "cannot get route.");
      }
    });
  };

  GSVHyperlapse.prototype.analyze = function(res) {
    var a, b, d, i, j, k, legs, m, path, pt, r, ref, ref1, route, self, totalDist;
    this.traceBold("analyze");
    _class.onMessage.call(this, "analyzing route..");
    this.trace(res.routes);
    this.rawPts = [];
    route = res.routes[0];
    path = route.overview_path;
    legs = route.legs;
    totalDist = 0;
    for (i = j = 0, ref = legs.length - 1; 0 <= ref ? j <= ref : j >= ref; i = 0 <= ref ? ++j : --j) {
      totalDist += legs[i].distance.value;
    }
    d = 0;
    r = 0;
    m = 0;
    a = b = null;
    this.trace("total distance:", totalDist);
    for (i = k = 0, ref1 = path.length - 2; 0 <= ref1 ? k <= ref1 : k >= ref1; i = 0 <= ref1 ? ++k : --k) {
      a = path[i];
      b = path[i + 1];
      d = google.maps.geometry.spherical.computeDistanceBetween(a, b);
      m = -r + this.step;
      if (d < m) {
        r += d;
      } else {
        while (m < d) {
          pt = getFollowedPath(m, a, b);
          this.rawPts.push(pt);
          m += this.step;
        }
        r = this.step - (m - d);
      }
    }
    this.trace("points:", this.rawPts.length);
    this.traceBold("fetch panoramas");
    this.loader = new GSVPANO.PanoLoader({
      zoom: this.quality
    });
    this.glsl = Glsl({
      canvas: document.createElement('canvas'),
      fragment: document.getElementById("pano-rotation").textContent,
      variables: {
        rotation: 0.0,
        pitch: 0.0,
        original: this.loader.canvas
      }
    });
    this.glsl.setSize(this.loader.width, this.loader.height);
    _class.onMessage.call(this, "composing panorama.. length:" + this.rawPts.length + " size:" + this.loader.width + "x" + this.loader.height);
    self = this;
    this.loader.onError = function(msg) {
      return _class.onMessage.call(this, "error");
    };
    this.loader.onPanoramaLoad = function() {
      return self.onLoadPanoImage.call(self);
    };
    this.prevId = "";
    this.index = 0;
    this.numPanorama = 0;
    return this.parsePoint();
  };

  GSVHyperlapse.prototype.parsePoint = function() {
    var self;
    if (this.bCancel) {
      return;
    }
    if (this.index === this.rawPts.length) {
      this.handleComplete();
      return;
    }
    self = this;
    this.trace(this.rawPts[this.index]);
    return this.loader.load(this.rawPts[this.index], function() {
      return self.onLoadPanoInfo.call(self);
    });
  };

  GSVHyperlapse.prototype.onLoadPanoInfo = function() {
    var id;
    id = this.loader.id;
    this.trace(this.loader.pitch, this.loader.rotation);
    if (this.prevId === id) {
      this.trace(this.index, " - skipped");
      this.index += 1;
      this.parsePoint();
    } else {
      this.trace(this.index, id);
      this.loader.composePanorama(id);
    }
    return this.prevId = id;
  };

  GSVHyperlapse.prototype.onLoadPanoImage = function() {
    var self;
    this.index += 1;
    this.glsl.set('rotation', this.loader.rotation);
    this.glsl.set('pitch', this.loader.pitch);
    this.glsl.syncAll();
    this.glsl.render();
    this.trace("rotation", this.loader.rotation, "pitch", this.loader.pitch);
    _class.onPanoramaLoad.call(this, this.glsl.canvas, this.index, this.rawPts.length);
    this.numPanorama += 1;
    self = this;
    return setTimeout(function() {
      return self.parsePoint();
    }, 100);
  };

  GSVHyperlapse.prototype.handleComplete = function() {
    this.traceBold("complete");
    this.trace("total panorama:", this.numPanorama);
    return _class.onMessage.call(this, "complete - total: " + this.numPanorama + ", duration: " + (this.numPanorama / 23.976));
  };

  return GSVHyperlapse;

})();

//# sourceMappingURL=data:application/json;base64,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QUFDLENBQUEsS0FBN0MsRUFBb0QsSUFBQyxDQUFBLE1BQU0sQ0FBQyxNQUE1RCxDQVRBLENBQUE7QUFBQSxJQVlBLElBQUMsQ0FBQSxXQUFELElBQWdCLENBWmhCLENBQUE7QUFBQSxJQWNBLElBQUEsR0FBTyxJQWRQLENBQUE7V0FlQSxVQUFBLENBQVcsU0FBQSxHQUFBO2FBQ1YsSUFBSSxDQUFDLFVBQUwsQ0FBQSxFQURVO0lBQUEsQ0FBWCxFQUVFLEdBRkYsRUFoQmdCO0VBQUEsQ0FuTWpCLENBQUE7O0FBQUEsMEJBeU5BLGNBQUEsR0FBZ0IsU0FBQSxHQUFBO0FBQ2YsSUFBQSxJQUFDLENBQUEsU0FBRCxDQUFXLFVBQVgsQ0FBQSxDQUFBO0FBQUEsSUFDQSxJQUFDLENBQUEsS0FBRCxDQUFPLGlCQUFQLEVBQTBCLElBQUMsQ0FBQSxXQUEzQixDQURBLENBQUE7V0FHQSxNQUFNLENBQUMsU0FBUyxDQUFDLElBQWpCLENBQXNCLElBQXRCLEVBQXlCLG9CQUFBLEdBQXFCLElBQUMsQ0FBQSxXQUF0QixHQUFrQyxjQUFsQyxHQUErQyxDQUFDLElBQUMsQ0FBQSxXQUFELEdBQWUsTUFBaEIsQ0FBeEUsRUFKZTtFQUFBLENBek5oQixDQUFBOzt1QkFBQTs7SUEvQkQsQ0FBQSIsImZpbGUiOiJHU1ZIeXBlcmxhcHNlLmpzIiwic291cmNlUm9vdCI6Ii9zb3VyY2UvIiwic291cmNlc0NvbnRlbnQiOlsiTnVtYmVyLnByb3RvdHlwZS50b1JhZCA9ICgpIC0+IEAgKiBNYXRoLlBJIC8gMTgwXG5cbk51bWJlci5wcm90b3R5cGUudG9EZWcgPSAoKSAtPiBAICogMTgwIC8gTWF0aC5QSVxuXG5wb2ludE9uTGluZSA9ICh0LCBhLCBiKSAtPlxuXHRsYXQxID0gYS5sYXQoKS50b1JhZCgpXG5cdGxuZzEgPSBhLmxuZygpLnRvUmFkKClcblxuXHRsYXQyID0gYi5sYXQoKS50b1JhZCgpXG5cdGxuZzIgPSBiLmxuZygpLnRvUmFkKClcblxuXHR4ID0gbGF0MSArIHQgKiAobGF0MiAtIGxhdDEpO1xuXHR5ID0gbG5nMSArIHQgKiAobG5nMiAtIGxuZzEpO1xuXG5cdHJldHVybiBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHgudG9EZWcoKSwgeS50b0RlZygpKVxuXG5nZXRGb2xsb3dlZFBhdGggPSAobSwgYSwgYikgLT5cblx0ZCA9IGdvb2dsZS5tYXBzLmdlb21ldHJ5LnNwaGVyaWNhbC5jb21wdXRlRGlzdGFuY2VCZXR3ZWVuKGEsIGIpXG5cblx0aWYgbSA8IDAgfHwgZCA8IG1cblx0XHRhbGVydChcImVycm9yIGdldEZvbG93ZWRQYXRoXCIpXG5cblx0dCA9IG0gLyBkXG5cblx0cmV0dXJuIHBvaW50T25MaW5lKHQsIGEsIGIpXG5cblxuXG5jbGFzcyBHU1ZIeXBlcmxhcHNlXG5cblx0IyBjb25zdFxuXHRAQVBJX0tFWSA9IFwiQUl6YVN5QlEyZHpEZnlGOFkwRHdlLVE2Snp4NF9HNjJBTnJUb3RRXCJcblx0QERJU1RfQkVUV0VFTl9QVFMgPSA1XG5cdEBNQVhfUFRTID0gMTAwXG5cblx0IyBzdGF0aWMgdmFyXG5cdEBkaXJTZXJ2aWNlID0gbmV3IGdvb2dsZS5tYXBzLkRpcmVjdGlvbnNTZXJ2aWNlKHt9KVxuXHRAZGlyUmVnZXggPSAvZGlyXFwvKFswLTkuLV0qKSwoWzAtOS4tXSopXFwvKFswLTkuLV0qKSwoWzAtOS4tXSopXFwvQChbMC05Li1dKiksKFswLTkuLV0qKSwoWzAtOV0qKXpcXC9kYXRhPSguKikkL1xuXHRAZGF0YVJlZ2V4ID0gLyExZChbMC05Li1dKikhMmQoWzAtOS4tXSopL2dcblx0QGRhdGFMYXRMbmdSZWdleCA9IC8hMWQoWzAtOS4tXSopITJkKFswLTkuLV0qKS9cblxuXHQjIGxvYWRlclxuXHRAbGRyID0gbmV3IEdTVlBBTk8uUGFub0xvYWRlcigpXG5cdEBsZHJTdGFjayA9IFtdXG5cblx0X2NsYXNzID0gQFxuXG5cdCMgZXZlbnRcblx0QG9uRXJyb3IgPSAoZXJyKSAtPiBhbGVydChcImVycm9yXCIpXG5cdEBvbk1lc3NhZ2VcdD0gKCkgLT4gbnVsbFxuXHRAb25QYW5vcmFtYUxvYWQgXHQ9ICgpIC0+IG51bGxcblxuXHQjIGNvbnN0cnVjdG9yXG5cdGNvbnN0cnVjdG9yOiAoYXJncykgLT5cblx0XHRAdXJsID0gYXJncy51cmxcblx0XHRAbmFtZSA9IGFyZ3MubmFtZVxuXHRcdEBzdGVwID0gcGFyc2VGbG9hdCggYXJncy5zdGVwIClcblx0XHRAcXVhbGl0eSA9IGFyZ3MucXVhbGl0eVxuXHRcdEBiQ2FuY2VsID0gZmFsc2VcblxuXHQjIG1ldGhvZHNcblx0dHJhY2U6IChhcmdzLi4uKSAtPlxuXHRcdGNvbnNvbGUubG9nIFwiWyN7QG5hbWV9XVwiLCBhcmdzLi4uXG5cblx0dHJhY2VCb2xkOiAoc3RyKSAtPlxuXHRcdGNvbnNvbGUubG9nIFwiJWNbI3tAbmFtZX1dICN7c3RyfSAtLS0tLS0tLS0tLS0tLS0tLS0tLVwiLCBcImNvbG9yOm9yYW5nZTtmb250LXdlaWdodDpib2xkO1wiXG5cblx0Y3JlYXRlOiAtPlxuXHRcdEB0cmFjZUJvbGQgXCJjcmVhdGVcIlxuXG5cdFx0IyBwYXJzZSB1cmxcblx0XHRyZXN1bHQgPSBfY2xhc3MuZGlyUmVnZXguZXhlYyggQHVybCApXG5cblx0XHRpZiAhcmVzdWx0P1xuXHRcdFx0YWxlcnQgXCJ1bmNvXCJcblx0XHRcdF9jbGFzcy5vbk1lc3NhZ2UuY2FsbCBALCBcImNhbm5vdCBwYXJzZSB1cmxcIlxuXHRcdFx0cmV0dXJuXG5cblx0XHRAb3JpZ2luICAgICAgICAgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKCByZXN1bHRbMV0sIHJlc3VsdFsyXSApXG5cdFx0QGRlc3RpbmF0aW9uXHQ9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoIHJlc3VsdFszXSwgcmVzdWx0WzRdIClcblx0XHRAY2VudHJvaWQgICAgICAgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKCByZXN1bHRbNV0sIHJlc3VsdFs2XSApXG5cdFx0QHpvb20gICAgICAgICAgID0gcmVzdWx0WzddXG5cblx0XHRAdHJhY2UgXCJvcmlnaW46IFwiICsgQG9yaWdpbiwgXCJkZXN0aW5hdGlvbjogXCIgKyBAZGVzdGluYXRpb25cblxuXHRcdHJlcSA9XG5cdFx0XHRvcmlnaW46IEBvcmlnaW5cblx0XHRcdGRlc3RpbmF0aW9uOiBAZGVzdGluYXRpb25cblx0XHRcdHRyYXZlbE1vZGU6IGdvb2dsZS5tYXBzLkRpcmVjdGlvbnNUcmF2ZWxNb2RlLldBTEtJTkcgI0RSSVZJTkdcblxuXG5cdFx0IyBwYXJzZSB3YXlwb2ludCBmcm9tIGRhdGFcblx0XHRAd2F5cG9pbnRzID0gW11cblx0XHRkYXRhICAgPSByZXN1bHRbOF1cblx0XHRyZXN1bHQgPSBkYXRhLm1hdGNoKCBHU1ZIeXBlcmxhcHNlLmRhdGFSZWdleCApXG5cblx0XHRpZiByZXN1bHQ/XG5cdFx0XHRmb3IgaSwgciBvZiByZXN1bHRcblx0XHRcdFx0bSA9IEdTVkh5cGVybGFwc2UuZGF0YUxhdExuZ1JlZ2V4LmV4ZWMoIHIgKVxuXHRcdFx0XHR3cCA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoIG1bMl0sIG1bMV0gKVxuXHRcdFx0XHRAd2F5cG9pbnRzLnB1c2hcblx0XHRcdFx0XHRsb2NhdGlvbjogd3AudG9TdHJpbmcoKVxuXHRcdFx0XHRcdHN0b3BvdmVyOiBmYWxzZVxuXG5cdFx0XHRAdHJhY2UgXCJudW0gb2Ygd2F5cG9pbnRzOlwiLCBAd2F5cG9pbnRzLmxlbmd0aFxuXHRcdFx0cmVxLndheXBvaW50cyA9IEB3YXlwb2ludHNcblxuXHRcdEB0cmFjZSBcInJlcXVlc3Q6XCIsIHJlcVxuXG5cdFx0X3NlbGYgPSBAXG5cblx0XHRHU1ZIeXBlcmxhcHNlLmRpclNlcnZpY2Uucm91dGUgcmVxLCAocmVzLCBzdGF0dXMpIC0+XG5cdFx0XHRpZiBzdGF0dXMgPT0gZ29vZ2xlLm1hcHMuRGlyZWN0aW9uc1N0YXR1cy5PS1xuXHRcdFx0XHRfc2VsZi5hbmFseXplKHJlcylcblx0XHRcdGVsc2Vcblx0XHRcdFx0X2NsYXNzLm9uTWVzc2FnZS5jYWxsIEAsIFwiY2Fubm90IGdldCByb3V0ZS5cIlxuXG5cblx0YW5hbHl6ZTogKHJlcykgLT5cblx0XHRAdHJhY2VCb2xkIFwiYW5hbHl6ZVwiXG5cblx0XHRfY2xhc3Mub25NZXNzYWdlLmNhbGwgQCwgXCJhbmFseXppbmcgcm91dGUuLlwiXG5cblx0XHQjIGdldCBwb2ludHNcblx0XHRAdHJhY2UgcmVzLnJvdXRlc1xuXG5cdFx0QHJhd1B0cyA9IFtdXG5cdFx0cm91dGUgPSByZXMucm91dGVzWzBdXG5cdFx0cGF0aCA9IHJvdXRlLm92ZXJ2aWV3X3BhdGhcblx0XHRsZWdzID0gcm91dGUubGVnc1xuXG5cdFx0dG90YWxEaXN0ID0gMFxuXHRcdGZvciBpIGluIFswLi5sZWdzLmxlbmd0aC0xXVxuXHRcdFx0dG90YWxEaXN0ICs9IGxlZ3NbaV0uZGlzdGFuY2UudmFsdWVcblxuXHRcdGQgPSAwICMgZGlzdGFuY2UgYmV0d2VlbiBhIGFuZCBiIChtKVxuXHRcdHIgPSAwICMgYWx3YXlzIG11c3QgYmUgPCBzdGVwXG5cdFx0bSA9IDBcblx0XHRhID0gYiA9IG51bGxcblxuXHRcdEB0cmFjZSBcInRvdGFsIGRpc3RhbmNlOlwiLCB0b3RhbERpc3RcblxuXHRcdCMgcmV0cml2ZSB0byB3YXkgcG9pbnRzXG5cdFx0Zm9yIGkgaW4gWzAuLnBhdGgubGVuZ3RoLTJdXG5cblx0XHRcdGEgPSBwYXRoW2ldXG5cdFx0XHRiID0gcGF0aFtpKzFdXG5cdFx0XHRkID0gZ29vZ2xlLm1hcHMuZ2VvbWV0cnkuc3BoZXJpY2FsLmNvbXB1dGVEaXN0YW5jZUJldHdlZW4oYSwgYilcblxuXHRcdFx0IyBvZmZzZXQgLXJcblx0XHRcdG0gPSAtciArIEBzdGVwXG5cblx0XHRcdGlmIGQgPCBtXG5cdFx0XHRcdHIgKz0gZFxuXHRcdFx0ZWxzZVxuXHRcdFx0XHQjIHN1YmRpdmlkZVxuXHRcdFx0XHR3aGlsZSBtIDwgZFxuXHRcdFx0XHRcdHB0ID0gZ2V0Rm9sbG93ZWRQYXRoKG0sIGEsIGIpXG5cdFx0XHRcdFx0QHJhd1B0cy5wdXNoKCBwdCApXG5cdFx0XHRcdFx0bSArPSBAc3RlcFxuXG5cdFx0XHRcdHIgPSBAc3RlcCAtIChtIC0gZClcblxuXHRcdEB0cmFjZSBcInBvaW50czpcIiwgQHJhd1B0cy5sZW5ndGhcblx0XHRAdHJhY2VCb2xkIFwiZmV0Y2ggcGFub3JhbWFzXCJcblxuXHRcdCMgc3RhcnQgcGFyc2UgcG9pbnRcblx0XHRAbG9hZGVyID0gbmV3IEdTVlBBTk8uUGFub0xvYWRlclxuXHRcdFx0em9vbTogQHF1YWxpdHlcblxuXHRcdEBnbHNsID0gR2xzbFxuXHRcdFx0Y2FudmFzOiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKVxuXHRcdFx0ZnJhZ21lbnQ6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGFuby1yb3RhdGlvblwiKS50ZXh0Q29udGVudFxuXHRcdFx0dmFyaWFibGVzOlxuXHRcdFx0XHRyb3RhdGlvbjogMC4wXG5cdFx0XHRcdHBpdGNoOiAwLjBcblx0XHRcdFx0b3JpZ2luYWw6IEBsb2FkZXIuY2FudmFzXG5cblx0XHRAZ2xzbC5zZXRTaXplKEBsb2FkZXIud2lkdGgsIEBsb2FkZXIuaGVpZ2h0KVxuXG5cdFx0X2NsYXNzLm9uTWVzc2FnZS5jYWxsIEAsIFwiY29tcG9zaW5nIHBhbm9yYW1hLi4gbGVuZ3RoOiN7QHJhd1B0cy5sZW5ndGh9IHNpemU6I3tAbG9hZGVyLndpZHRofXgje0Bsb2FkZXIuaGVpZ2h0fVwiXG5cdFx0XG5cdFx0c2VsZiA9IEBcblx0XHRAbG9hZGVyLm9uRXJyb3IgPSAobXNnKSAtPlxuXHRcdFx0X2NsYXNzLm9uTWVzc2FnZS5jYWxsIEAsIFwiZXJyb3JcIlxuXG5cdFx0QGxvYWRlci5vblBhbm9yYW1hTG9hZCA9IC0+XG5cdFx0XHRzZWxmLm9uTG9hZFBhbm9JbWFnZS5jYWxsIHNlbGZcblxuXG5cdFx0QHByZXZJZCA9IFwiXCJcblx0XHRAaW5kZXggPSAwXG5cdFx0QG51bVBhbm9yYW1hID0gMFxuXG5cdFx0QHBhcnNlUG9pbnQoKVxuXG5cdCMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0cGFyc2VQb2ludDogLT5cblxuXHRcdGlmIEBiQ2FuY2VsXG5cdFx0XHRyZXR1cm5cblxuXHRcdGlmIEBpbmRleCA9PSBAcmF3UHRzLmxlbmd0aFxuXHRcdFx0QGhhbmRsZUNvbXBsZXRlKClcblx0XHRcdHJldHVyblxuXHRcdFxuXHRcdHNlbGYgPSBAXG5cdFx0QHRyYWNlIEByYXdQdHNbQGluZGV4XVxuXHRcdEBsb2FkZXIubG9hZCBAcmF3UHRzW0BpbmRleF0sIC0+XG5cdFx0XHRzZWxmLm9uTG9hZFBhbm9JbmZvLmNhbGwgc2VsZlxuXG5cdG9uTG9hZFBhbm9JbmZvOiAtPlxuXHRcdGlkID0gQGxvYWRlci5pZFxuXG5cdFx0QHRyYWNlIEBsb2FkZXIucGl0Y2gsIEBsb2FkZXIucm90YXRpb25cblxuXHRcdGlmIEBwcmV2SWQgPT0gaWRcblx0XHRcdEB0cmFjZSBAaW5kZXgsIFwiIC0gc2tpcHBlZFwiXG5cdFx0XHRAaW5kZXggKz0gMVxuXHRcdFx0QHBhcnNlUG9pbnQoKVxuXHRcdGVsc2Vcblx0XHRcdEB0cmFjZSBAaW5kZXgsIGlkXG5cdFx0XHRAbG9hZGVyLmNvbXBvc2VQYW5vcmFtYSggaWQgKVxuXG5cdFx0QHByZXZJZCA9IGlkXG5cblx0b25Mb2FkUGFub0ltYWdlOiAtPlxuXHRcdEBpbmRleCArPSAxXG5cblx0XHRAZ2xzbC5zZXQoJ3JvdGF0aW9uJywgQGxvYWRlci5yb3RhdGlvbilcblx0XHRAZ2xzbC5zZXQoJ3BpdGNoJywgQGxvYWRlci5waXRjaClcblx0XHRAZ2xzbC5zeW5jQWxsKClcblx0XHRAZ2xzbC5yZW5kZXIoKVxuXG5cdFx0QHRyYWNlIFwicm90YXRpb25cIiwgQGxvYWRlci5yb3RhdGlvbiwgXCJwaXRjaFwiLCBAbG9hZGVyLnBpdGNoXG5cblx0XHRfY2xhc3Mub25QYW5vcmFtYUxvYWQuY2FsbCBALCBAZ2xzbC5jYW52YXMsIEBpbmRleCwgQHJhd1B0cy5sZW5ndGhcblxuXHRcdCMgbmV4dCBmcmFtZVxuXHRcdEBudW1QYW5vcmFtYSArPSAxXG5cdFx0XG5cdFx0c2VsZiA9IEBcblx0XHRzZXRUaW1lb3V0IC0+XG5cdFx0XHRzZWxmLnBhcnNlUG9pbnQoKVxuXHRcdCwgMTAwXG5cblx0IyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG5cdGhhbmRsZUNvbXBsZXRlOiAtPlxuXHRcdEB0cmFjZUJvbGQgXCJjb21wbGV0ZVwiXG5cdFx0QHRyYWNlIFwidG90YWwgcGFub3JhbWE6XCIsIEBudW1QYW5vcmFtYVxuXG5cdFx0X2NsYXNzLm9uTWVzc2FnZS5jYWxsIEAsIFwiY29tcGxldGUgLSB0b3RhbDogI3tAbnVtUGFub3JhbWF9LCBkdXJhdGlvbjogI3tAbnVtUGFub3JhbWEgLyAyMy45NzZ9XCJcblxuXG5cblxuXG5cblxuXG5cblxuIl19