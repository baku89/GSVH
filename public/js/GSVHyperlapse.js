var API_KEY, GSVHyperlapse, getFollowedPath, pointOnLine,
  slice = [].slice;

Number.prototype.toRad = function() {
  return this * Math.PI / 180;
};

Number.prototype.toDeg = function() {
  return this * 180 / Math.PI;
};

API_KEY = "AIzaSyBQ2dzDfyF8Y0Dwe-Q6Jzx4_G62ANrTotQ";

pointOnLine = function(t, a, b) {
  var lat1, lat2, lng1, lng2, x, y;
  lat1 = a.lat().toRad();
  lng1 = a.lng().toRad();
  lat2 = b.lat().toRad();
  lng2 = b.lng().toRad();
  x = lat1 + t * (lat2 - lat1);
  y = lng1 + t * (lng2 - lng1);
  return new google.maps.LatLng(x.toDeg(), y.toDeg());
};

getFollowedPath = function(m, a, b) {
  var d, t;
  d = google.maps.geometry.spherical.computeDistanceBetween(a, b);
  if (m < 0 || d < m) {
    alert("error getFolowedPath");
  }
  t = m / d;
  return pointOnLine(t, a, b);
};

GSVHyperlapse = (function() {
  var _class;

  GSVHyperlapse.API_KEY = "AIzaSyBQ2dzDfyF8Y0Dwe-Q6Jzx4_G62ANrTotQ";

  GSVHyperlapse.DIST_BETWEEN_PTS = 5;

  GSVHyperlapse.MAX_PTS = 100;

  GSVHyperlapse.dirService = new google.maps.DirectionsService({});

  GSVHyperlapse.dirRegex = /dir\/([0-9.-]*),([0-9.-]*)\/([0-9.-]*),([0-9.-]*)\/@([0-9.-]*),([0-9.-]*),([0-9]*)z\/data=(.*)$/;

  GSVHyperlapse.dataRegex = /!1d([0-9.-]*)!2d([0-9.-]*)/g;

  GSVHyperlapse.dataLatLngRegex = /!1d([0-9.-]*)!2d([0-9.-]*)/;

  GSVHyperlapse.ldr = new GSVPANO.PanoLoader();

  GSVHyperlapse.ldrStack = [];

  _class = GSVHyperlapse;

  GSVHyperlapse.onError = function(err) {
    return alert("error");
  };

  GSVHyperlapse.onMessage = function() {
    return null;
  };

  GSVHyperlapse.onPanoramaLoad = function() {
    return null;
  };

  function GSVHyperlapse(args) {
    this.url = args.url;
    this.name = args.name;
    this.step = parseFloat(args.step);
    this.quality = args.quality;
    this.bCancel = false;
    if (args.travelMode === 'driving') {
      this.travelMode = google.maps.DirectionsTravelMode.DRIVING;
    } else if (args.travelMode === 'walking') {
      this.travelMode = google.maps.DirectionsTravelMode.WALKING;
    }
  }

  GSVHyperlapse.prototype.setMap = function(elm) {
    return this.mapElm = elm;
  };

  GSVHyperlapse.prototype.trace = function() {
    var args;
    args = 1 <= arguments.length ? slice.call(arguments, 0) : [];
    return console.log.apply(console, ["[" + this.name + "]"].concat(slice.call(args)));
  };

  GSVHyperlapse.prototype.traceBold = function(str) {
    return console.log("%c[" + this.name + "] " + str + " --------------------", "color:orange;font-weight:bold;");
  };

  GSVHyperlapse.prototype.create = function() {
    var _self, data, i, m, r, req, result, wp;
    this.traceBold("create");
    result = _class.dirRegex.exec(this.url);
    if (result == null) {
      alert("unco");
      _class.onMessage.call(this, "cannot parse url");
      return;
    }
    this.origin = new google.maps.LatLng(result[1], result[2]);
    this.destination = new google.maps.LatLng(result[3], result[4]);
    this.centroid = new google.maps.LatLng(result[5], result[6]);
    this.zoom = parseInt(result[7]);
    this.trace("origin: " + this.origin, "destination: " + this.destination);
    req = {
      origin: this.origin,
      destination: this.destination,
      travelMode: this.travelMode
    };
    this.waypoints = [];
    data = result[8];
    result = data.match(GSVHyperlapse.dataRegex);
    if (result != null) {
      for (i in result) {
        r = result[i];
        m = GSVHyperlapse.dataLatLngRegex.exec(r);
        wp = new google.maps.LatLng(m[2], m[1]);
        this.waypoints.push({
          location: wp.toString(),
          stopover: false
        });
      }
      this.trace("num of waypoints:", this.waypoints.length);
      req.waypoints = this.waypoints;
    }
    this.trace("request:", req);
    _self = this;
    this.map = new google.maps.Map(this.mapElm, {
      center: this.centroid,
      zoom: this.zoom,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    });
    return GSVHyperlapse.dirService.route(req, function(res, status) {
      if (status === google.maps.DirectionsStatus.OK) {
        return _self.analyze(res);
      } else {
        return _class.onMessage.call(this, "cannot get route.");
      }
    });
  };

  GSVHyperlapse.prototype.analyze = function(res) {
    var a, b, d, i, j, k, legs, m, marker, path, pt, r, ref, ref1, ref2, route, self, totalDist;
    this.traceBold("analyze");
    _class.onMessage.call(this, "analyzing route..");
    this.trace(res.routes);
    this.rawPts = [];
    route = res.routes[0];
    path = route.overview_path;
    legs = route.legs;
    totalDist = 0;
    for (i = j = 0, ref = legs.length - 1; 0 <= ref ? j <= ref : j >= ref; i = 0 <= ref ? ++j : --j) {
      totalDist += legs[i].distance.value;
    }
    d = 0;
    r = 0;
    m = 0;
    a = b = null;
    this.trace("total distance:", totalDist);
    for (i = k = 0, ref1 = path.length - 2; 0 <= ref1 ? k <= ref1 : k >= ref1; i = 0 <= ref1 ? ++k : --k) {
      a = path[i];
      b = path[i + 1];
      d = google.maps.geometry.spherical.computeDistanceBetween(a, b);
      m = -r + this.step;
      if (d < m) {
        r += d;
      } else {
        while (m < d) {
          pt = getFollowedPath(m, a, b);
          this.rawPts.push(pt);
          m += this.step;
        }
        r = this.step - (m - d);
      }
    }
    this.trace("points:", this.rawPts.length);
    this.traceBold("fetch panoramas");
    this.map.fitBounds(route.bounds);
    ref2 = this.rawPts;
    for (i in ref2) {
      pt = ref2[i];
      marker = new google.maps.Marker({
        position: pt,
        map: this.map,
        title: "" + i
      });
    }
    this.loader = new GSVPANO.PanoLoader({
      zoom: this.quality
    });
    this.glsl = Glsl({
      canvas: document.createElement('canvas'),
      fragment: document.getElementById("pano-rotation").textContent,
      variables: {
        rotation: 0.0,
        pitch: 0.0,
        original: this.loader.canvas
      }
    });
    this.glsl.setSize(this.loader.width, this.loader.height);
    _class.onMessage.call(this, "composing panorama.. length:" + this.rawPts.length + " size:" + this.loader.width + "x" + this.loader.height);
    self = this;
    this.loader.onError = function(msg) {
      return _class.onMessage.call(this, "error");
    };
    this.loader.onPanoramaLoad = function() {
      return self.onLoadPanoImage.call(self);
    };
    this.loader.onNoPanoramaData = function(status) {
      return console.log(status);
    };
    this.prevId = "";
    this.index = 0;
    this.numPanorama = 0;
    return this.parsePoint();
  };

  GSVHyperlapse.prototype.parsePoint = function() {
    var self;
    if (this.bCancel) {
      return;
    }
    if (this.index === this.rawPts.length) {
      this.handleComplete();
      return;
    }
    self = this;
    return this.loader.load(this.rawPts[this.index], function() {
      return self.onLoadPanoInfo.call(self);
    });
  };

  GSVHyperlapse.prototype.onLoadPanoInfo = function() {
    var id;
    id = this.loader.id;
    this.trace(this.loader.pitch, this.loader.rotation);
    if (this.prevId === id) {
      this.trace(this.index, " - skipped");
      this.index += 1;
      this.parsePoint();
    } else {
      this.trace(this.index, id, this.rawPts[this.index]);
      this.loader.composePanorama(id);
    }
    return this.prevId = id;
  };

  GSVHyperlapse.prototype.onLoadPanoImage = function() {
    var self;
    this.index += 1;
    this.glsl.set('rotation', this.loader.rotation);
    this.glsl.set('pitch', this.loader.pitch);
    this.glsl.syncAll();
    this.glsl.render();
    _class.onPanoramaLoad.call(this, this.glsl.canvas, this.index, this.rawPts.length);
    this.numPanorama += 1;
    self = this;
    return setTimeout(function() {
      return self.parsePoint();
    }, 100);
  };

  GSVHyperlapse.prototype.handleComplete = function() {
    this.traceBold("complete");
    this.trace("total panorama:", this.numPanorama);
    return _class.onMessage.call(this, "complete - total: " + this.numPanorama + ", duration: " + (this.numPanorama / 23.976));
  };

  return GSVHyperlapse;

})();

//# sourceMappingURL=data:application/json;base64,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QUEsSUFjQSxJQUFBLEdBQU8sSUFkUCxDQUFBO1dBZUEsVUFBQSxDQUFXLFNBQUEsR0FBQTthQUNWLElBQUksQ0FBQyxVQUFMLENBQUEsRUFEVTtJQUFBLENBQVgsRUFFRSxHQUZGLEVBaEJnQjtFQUFBLENBNU5qQixDQUFBOztBQUFBLDBCQWtQQSxjQUFBLEdBQWdCLFNBQUEsR0FBQTtBQUNmLElBQUEsSUFBQyxDQUFBLFNBQUQsQ0FBVyxVQUFYLENBQUEsQ0FBQTtBQUFBLElBQ0EsSUFBQyxDQUFBLEtBQUQsQ0FBTyxpQkFBUCxFQUEwQixJQUFDLENBQUEsV0FBM0IsQ0FEQSxDQUFBO1dBR0EsTUFBTSxDQUFDLFNBQVMsQ0FBQyxJQUFqQixDQUFzQixJQUF0QixFQUF5QixvQkFBQSxHQUFxQixJQUFDLENBQUEsV0FBdEIsR0FBa0MsY0FBbEMsR0FBK0MsQ0FBQyxJQUFDLENBQUEsV0FBRCxHQUFlLE1BQWhCLENBQXhFLEVBSmU7RUFBQSxDQWxQaEIsQ0FBQTs7dUJBQUE7O0lBakNELENBQUEiLCJmaWxlIjoiR1NWSHlwZXJsYXBzZS5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyIsInNvdXJjZXNDb250ZW50IjpbIk51bWJlci5wcm90b3R5cGUudG9SYWQgPSAoKSAtPiBAICogTWF0aC5QSSAvIDE4MFxuXG5OdW1iZXIucHJvdG90eXBlLnRvRGVnID0gKCkgLT4gQCAqIDE4MCAvIE1hdGguUElcblxuQVBJX0tFWSA9IFwiQUl6YVN5QlEyZHpEZnlGOFkwRHdlLVE2Snp4NF9HNjJBTnJUb3RRXCJcblxucG9pbnRPbkxpbmUgPSAodCwgYSwgYikgLT5cblx0bGF0MSA9IGEubGF0KCkudG9SYWQoKVxuXHRsbmcxID0gYS5sbmcoKS50b1JhZCgpXG5cblx0bGF0MiA9IGIubGF0KCkudG9SYWQoKVxuXHRsbmcyID0gYi5sbmcoKS50b1JhZCgpXG5cblx0eCA9IGxhdDEgKyB0ICogKGxhdDIgLSBsYXQxKTtcblx0eSA9IGxuZzEgKyB0ICogKGxuZzIgLSBsbmcxKTtcblxuXHRyZXR1cm4gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyh4LnRvRGVnKCksIHkudG9EZWcoKSlcblxuZ2V0Rm9sbG93ZWRQYXRoID0gKG0sIGEsIGIpIC0+XG5cdGQgPSBnb29nbGUubWFwcy5nZW9tZXRyeS5zcGhlcmljYWwuY29tcHV0ZURpc3RhbmNlQmV0d2VlbihhLCBiKVxuXG5cdGlmIG0gPCAwIHx8IGQgPCBtXG5cdFx0YWxlcnQoXCJlcnJvciBnZXRGb2xvd2VkUGF0aFwiKVxuXG5cdHQgPSBtIC8gZFxuXG5cdHJldHVybiBwb2ludE9uTGluZSh0LCBhLCBiKVxuXG5cblxuY2xhc3MgR1NWSHlwZXJsYXBzZVxuXG5cdCMgY29uc3Rcblx0QEFQSV9LRVkgPSBcIkFJemFTeUJRMmR6RGZ5RjhZMER3ZS1RNkp6eDRfRzYyQU5yVG90UVwiXG5cdEBESVNUX0JFVFdFRU5fUFRTID0gNVxuXHRATUFYX1BUUyA9IDEwMFxuXG5cdCMgc3RhdGljIHZhclxuXHRAZGlyU2VydmljZSA9IG5ldyBnb29nbGUubWFwcy5EaXJlY3Rpb25zU2VydmljZSh7fSlcblx0QGRpclJlZ2V4ID0gL2RpclxcLyhbMC05Li1dKiksKFswLTkuLV0qKVxcLyhbMC05Li1dKiksKFswLTkuLV0qKVxcL0AoWzAtOS4tXSopLChbMC05Li1dKiksKFswLTldKil6XFwvZGF0YT0oLiopJC9cblx0QGRhdGFSZWdleCA9IC8hMWQoWzAtOS4tXSopITJkKFswLTkuLV0qKS9nXG5cdEBkYXRhTGF0TG5nUmVnZXggPSAvITFkKFswLTkuLV0qKSEyZChbMC05Li1dKikvXG5cblx0IyBsb2FkZXJcblx0QGxkciA9IG5ldyBHU1ZQQU5PLlBhbm9Mb2FkZXIoKVxuXHRAbGRyU3RhY2sgPSBbXVxuXG5cdF9jbGFzcyA9IEBcblxuXHQjIGV2ZW50XG5cdEBvbkVycm9yID0gKGVycikgLT4gYWxlcnQoXCJlcnJvclwiKVxuXHRAb25NZXNzYWdlXHQ9ICgpIC0+IG51bGxcblx0QG9uUGFub3JhbWFMb2FkIFx0PSAoKSAtPiBudWxsXG5cblx0IyBjb25zdHJ1Y3RvclxuXHRjb25zdHJ1Y3RvcjogKGFyZ3MpIC0+XG5cdFx0QHVybCA9IGFyZ3MudXJsXG5cdFx0QG5hbWUgPSBhcmdzLm5hbWVcblx0XHRAc3RlcCA9IHBhcnNlRmxvYXQoIGFyZ3Muc3RlcCApXG5cdFx0QHF1YWxpdHkgPSBhcmdzLnF1YWxpdHlcblx0XHRAYkNhbmNlbCA9IGZhbHNlXG5cblx0XHRpZiBhcmdzLnRyYXZlbE1vZGUgPT0gJ2RyaXZpbmcnXG5cdFx0XHRAdHJhdmVsTW9kZSA9IGdvb2dsZS5tYXBzLkRpcmVjdGlvbnNUcmF2ZWxNb2RlLkRSSVZJTkdcblx0XHRlbHNlIGlmIGFyZ3MudHJhdmVsTW9kZSA9PSAnd2Fsa2luZydcblx0XHRcdEB0cmF2ZWxNb2RlID0gZ29vZ2xlLm1hcHMuRGlyZWN0aW9uc1RyYXZlbE1vZGUuV0FMS0lOR1xuXG5cdHNldE1hcDogKGVsbSkgLT5cblx0XHRAbWFwRWxtID0gZWxtXG5cblxuXHQjIG1ldGhvZHNcblx0dHJhY2U6IChhcmdzLi4uKSAtPlxuXHRcdGNvbnNvbGUubG9nIFwiWyN7QG5hbWV9XVwiLCBhcmdzLi4uXG5cblx0dHJhY2VCb2xkOiAoc3RyKSAtPlxuXHRcdGNvbnNvbGUubG9nIFwiJWNbI3tAbmFtZX1dICN7c3RyfSAtLS0tLS0tLS0tLS0tLS0tLS0tLVwiLCBcImNvbG9yOm9yYW5nZTtmb250LXdlaWdodDpib2xkO1wiXG5cblx0Y3JlYXRlOiAtPlxuXHRcdEB0cmFjZUJvbGQgXCJjcmVhdGVcIlxuXG5cdFx0IyBwYXJzZSB1cmxcblx0XHRyZXN1bHQgPSBfY2xhc3MuZGlyUmVnZXguZXhlYyggQHVybCApXG5cblx0XHRpZiAhcmVzdWx0P1xuXHRcdFx0YWxlcnQgXCJ1bmNvXCJcblx0XHRcdF9jbGFzcy5vbk1lc3NhZ2UuY2FsbCBALCBcImNhbm5vdCBwYXJzZSB1cmxcIlxuXHRcdFx0cmV0dXJuXG5cblx0XHRAb3JpZ2luICAgICAgICAgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKCByZXN1bHRbMV0sIHJlc3VsdFsyXSApXG5cdFx0QGRlc3RpbmF0aW9uXHQ9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoIHJlc3VsdFszXSwgcmVzdWx0WzRdIClcblx0XHRAY2VudHJvaWQgICAgICAgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKCByZXN1bHRbNV0sIHJlc3VsdFs2XSApXG5cdFx0QHpvb20gICAgICAgICAgID0gcGFyc2VJbnQocmVzdWx0WzddKVxuXG5cdFx0QHRyYWNlIFwib3JpZ2luOiBcIiArIEBvcmlnaW4sIFwiZGVzdGluYXRpb246IFwiICsgQGRlc3RpbmF0aW9uXG5cblx0XHRyZXEgPVxuXHRcdFx0b3JpZ2luOiBAb3JpZ2luXG5cdFx0XHRkZXN0aW5hdGlvbjogQGRlc3RpbmF0aW9uXG5cdFx0XHR0cmF2ZWxNb2RlOiBAdHJhdmVsTW9kZVxuXG5cblx0XHQjIHBhcnNlIHdheXBvaW50IGZyb20gZGF0YVxuXHRcdEB3YXlwb2ludHMgPSBbXVxuXHRcdGRhdGEgICA9IHJlc3VsdFs4XVxuXHRcdHJlc3VsdCA9IGRhdGEubWF0Y2goIEdTVkh5cGVybGFwc2UuZGF0YVJlZ2V4IClcblxuXHRcdGlmIHJlc3VsdD9cblx0XHRcdGZvciBpLCByIG9mIHJlc3VsdFxuXHRcdFx0XHRtID0gR1NWSHlwZXJsYXBzZS5kYXRhTGF0TG5nUmVnZXguZXhlYyggciApXG5cdFx0XHRcdHdwID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyggbVsyXSwgbVsxXSApXG5cdFx0XHRcdEB3YXlwb2ludHMucHVzaFxuXHRcdFx0XHRcdGxvY2F0aW9uOiB3cC50b1N0cmluZygpXG5cdFx0XHRcdFx0c3RvcG92ZXI6IGZhbHNlXG5cblx0XHRcdEB0cmFjZSBcIm51bSBvZiB3YXlwb2ludHM6XCIsIEB3YXlwb2ludHMubGVuZ3RoXG5cdFx0XHRyZXEud2F5cG9pbnRzID0gQHdheXBvaW50c1xuXG5cdFx0QHRyYWNlIFwicmVxdWVzdDpcIiwgcmVxXG5cblx0XHRfc2VsZiA9IEBcblxuXHRcdCMgY3JlYXRlIG1hcFxuXHRcdEBtYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwIEBtYXBFbG0sXG5cdFx0XHRjZW50ZXI6IEBjZW50cm9pZFxuXHRcdFx0em9vbTogQHpvb21cblx0XHRcdG1hcFR5cGVJZDogZ29vZ2xlLm1hcHMuTWFwVHlwZUlkLlJPQURNQVBcblxuXHRcdEdTVkh5cGVybGFwc2UuZGlyU2VydmljZS5yb3V0ZSByZXEsIChyZXMsIHN0YXR1cykgLT5cblx0XHRcdGlmIHN0YXR1cyA9PSBnb29nbGUubWFwcy5EaXJlY3Rpb25zU3RhdHVzLk9LXG5cdFx0XHRcdF9zZWxmLmFuYWx5emUocmVzKVxuXHRcdFx0ZWxzZVxuXHRcdFx0XHRfY2xhc3Mub25NZXNzYWdlLmNhbGwgQCwgXCJjYW5ub3QgZ2V0IHJvdXRlLlwiXG5cblxuXHRhbmFseXplOiAocmVzKSAtPlxuXHRcdEB0cmFjZUJvbGQgXCJhbmFseXplXCJcblxuXHRcdF9jbGFzcy5vbk1lc3NhZ2UuY2FsbCBALCBcImFuYWx5emluZyByb3V0ZS4uXCJcblxuXHRcdCMgZ2V0IHBvaW50c1xuXHRcdEB0cmFjZSByZXMucm91dGVzXG5cblx0XHRAcmF3UHRzID0gW11cblx0XHRyb3V0ZSA9IHJlcy5yb3V0ZXNbMF1cblx0XHRwYXRoID0gcm91dGUub3ZlcnZpZXdfcGF0aFxuXHRcdGxlZ3MgPSByb3V0ZS5sZWdzXG5cblx0XHR0b3RhbERpc3QgPSAwXG5cdFx0Zm9yIGkgaW4gWzAuLmxlZ3MubGVuZ3RoLTFdXG5cdFx0XHR0b3RhbERpc3QgKz0gbGVnc1tpXS5kaXN0YW5jZS52YWx1ZVxuXG5cdFx0ZCA9IDAgIyBkaXN0YW5jZSBiZXR3ZWVuIGEgYW5kIGIgKG0pXG5cdFx0ciA9IDAgIyBhbHdheXMgbXVzdCBiZSA8IHN0ZXBcblx0XHRtID0gMFxuXHRcdGEgPSBiID0gbnVsbFxuXG5cdFx0QHRyYWNlIFwidG90YWwgZGlzdGFuY2U6XCIsIHRvdGFsRGlzdFxuXG5cdFx0IyByZXRyaXZlIHRvIHdheSBwb2ludHNcblx0XHRmb3IgaSBpbiBbMC4ucGF0aC5sZW5ndGgtMl1cblxuXHRcdFx0YSA9IHBhdGhbaV1cblx0XHRcdGIgPSBwYXRoW2krMV1cblx0XHRcdGQgPSBnb29nbGUubWFwcy5nZW9tZXRyeS5zcGhlcmljYWwuY29tcHV0ZURpc3RhbmNlQmV0d2VlbihhLCBiKVxuXG5cdFx0XHQjIG9mZnNldCAtclxuXHRcdFx0bSA9IC1yICsgQHN0ZXBcblxuXHRcdFx0aWYgZCA8IG1cblx0XHRcdFx0ciArPSBkXG5cdFx0XHRlbHNlXG5cdFx0XHRcdCMgc3ViZGl2aWRlXG5cdFx0XHRcdHdoaWxlIG0gPCBkXG5cdFx0XHRcdFx0cHQgPSBnZXRGb2xsb3dlZFBhdGgobSwgYSwgYilcblx0XHRcdFx0XHRAcmF3UHRzLnB1c2goIHB0IClcblx0XHRcdFx0XHRtICs9IEBzdGVwXG5cblx0XHRcdFx0ciA9IEBzdGVwIC0gKG0gLSBkKVxuXG5cdFx0QHRyYWNlIFwicG9pbnRzOlwiLCBAcmF3UHRzLmxlbmd0aFxuXHRcdEB0cmFjZUJvbGQgXCJmZXRjaCBwYW5vcmFtYXNcIlxuXG5cdFx0IyBmaXQgYm91bmQgYW5kIGFkZCBwaW5cblx0XHRAbWFwLmZpdEJvdW5kcyggcm91dGUuYm91bmRzIClcblx0XHRmb3IgaSwgcHQgb2YgQHJhd1B0c1xuXHRcdFx0bWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlclxuXHRcdFx0XHRwb3NpdGlvbjogcHRcblx0XHRcdFx0bWFwOiBAbWFwXG5cdFx0XHRcdHRpdGxlOiBcIiN7aX1cIlxuXG5cdFx0IyBzdGFydCBwYXJzZSBwb2ludFxuXHRcdEBsb2FkZXIgPSBuZXcgR1NWUEFOTy5QYW5vTG9hZGVyXG5cdFx0XHR6b29tOiBAcXVhbGl0eVxuXG5cdFx0QGdsc2wgPSBHbHNsXG5cdFx0XHRjYW52YXM6IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpXG5cdFx0XHRmcmFnbWVudDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwYW5vLXJvdGF0aW9uXCIpLnRleHRDb250ZW50XG5cdFx0XHR2YXJpYWJsZXM6XG5cdFx0XHRcdHJvdGF0aW9uOiAwLjBcblx0XHRcdFx0cGl0Y2g6IDAuMFxuXHRcdFx0XHRvcmlnaW5hbDogQGxvYWRlci5jYW52YXNcblxuXHRcdEBnbHNsLnNldFNpemUoQGxvYWRlci53aWR0aCwgQGxvYWRlci5oZWlnaHQpXG5cblx0XHRfY2xhc3Mub25NZXNzYWdlLmNhbGwgQCwgXCJjb21wb3NpbmcgcGFub3JhbWEuLiBsZW5ndGg6I3tAcmF3UHRzLmxlbmd0aH0gc2l6ZToje0Bsb2FkZXIud2lkdGh9eCN7QGxvYWRlci5oZWlnaHR9XCJcblx0XHRcblx0XHRzZWxmID0gQFxuXHRcdEBsb2FkZXIub25FcnJvciA9IChtc2cpIC0+XG5cdFx0XHRfY2xhc3Mub25NZXNzYWdlLmNhbGwgQCwgXCJlcnJvclwiXG5cblx0XHRAbG9hZGVyLm9uUGFub3JhbWFMb2FkID0gLT5cblx0XHRcdHNlbGYub25Mb2FkUGFub0ltYWdlLmNhbGwgc2VsZlxuXG5cdFx0QGxvYWRlci5vbk5vUGFub3JhbWFEYXRhID0gKHN0YXR1cykgLT5cblx0XHRcdGNvbnNvbGUubG9nIHN0YXR1c1xuXG5cblx0XHRAcHJldklkID0gXCJcIlxuXHRcdEBpbmRleCA9IDBcblx0XHRAbnVtUGFub3JhbWEgPSAwXG5cblx0XHRAcGFyc2VQb2ludCgpXG5cblx0IyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRwYXJzZVBvaW50OiAtPlxuXG5cdFx0aWYgQGJDYW5jZWxcblx0XHRcdHJldHVyblxuXG5cdFx0aWYgQGluZGV4ID09IEByYXdQdHMubGVuZ3RoXG5cdFx0XHRAaGFuZGxlQ29tcGxldGUoKVxuXHRcdFx0cmV0dXJuXG5cdFx0XG5cdFx0c2VsZiA9IEBcblx0XHRAbG9hZGVyLmxvYWQgQHJhd1B0c1tAaW5kZXhdLCAtPlxuXHRcdFx0c2VsZi5vbkxvYWRQYW5vSW5mby5jYWxsIHNlbGZcblxuXHRvbkxvYWRQYW5vSW5mbzogLT5cblx0XHRpZCA9IEBsb2FkZXIuaWRcblxuXHRcdEB0cmFjZSBAbG9hZGVyLnBpdGNoLCBAbG9hZGVyLnJvdGF0aW9uXG5cblx0XHRpZiBAcHJldklkID09IGlkXG5cdFx0XHRAdHJhY2UgQGluZGV4LCBcIiAtIHNraXBwZWRcIlxuXHRcdFx0QGluZGV4ICs9IDFcblx0XHRcdEBwYXJzZVBvaW50KClcblx0XHRlbHNlXG5cdFx0XHRAdHJhY2UgQGluZGV4LCBpZCwgQHJhd1B0c1tAaW5kZXhdXG5cdFx0XHRAbG9hZGVyLmNvbXBvc2VQYW5vcmFtYSggaWQgKVxuXG5cdFx0QHByZXZJZCA9IGlkXG5cblx0b25Mb2FkUGFub0ltYWdlOiAtPlxuXHRcdEBpbmRleCArPSAxXG5cblx0XHRAZ2xzbC5zZXQoJ3JvdGF0aW9uJywgQGxvYWRlci5yb3RhdGlvbilcblx0XHRAZ2xzbC5zZXQoJ3BpdGNoJywgQGxvYWRlci5waXRjaClcblx0XHRAZ2xzbC5zeW5jQWxsKClcblx0XHRAZ2xzbC5yZW5kZXIoKVxuXG5cdFx0I0B0cmFjZSBcInJvdGF0aW9uXCIsIEBsb2FkZXIucm90YXRpb24sIFwicGl0Y2hcIiwgQGxvYWRlci5waXRjaFxuXG5cdFx0X2NsYXNzLm9uUGFub3JhbWFMb2FkLmNhbGwgQCwgQGdsc2wuY2FudmFzLCBAaW5kZXgsIEByYXdQdHMubGVuZ3RoXG5cblx0XHQjIG5leHQgZnJhbWVcblx0XHRAbnVtUGFub3JhbWEgKz0gMVxuXHRcdFxuXHRcdHNlbGYgPSBAXG5cdFx0c2V0VGltZW91dCAtPlxuXHRcdFx0c2VsZi5wYXJzZVBvaW50KClcblx0XHQsIDEwMFxuXG5cdCMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuXHRoYW5kbGVDb21wbGV0ZTogLT5cblx0XHRAdHJhY2VCb2xkIFwiY29tcGxldGVcIlxuXHRcdEB0cmFjZSBcInRvdGFsIHBhbm9yYW1hOlwiLCBAbnVtUGFub3JhbWFcblxuXHRcdF9jbGFzcy5vbk1lc3NhZ2UuY2FsbCBALCBcImNvbXBsZXRlIC0gdG90YWw6ICN7QG51bVBhbm9yYW1hfSwgZHVyYXRpb246ICN7QG51bVBhbm9yYW1hIC8gMjMuOTc2fVwiXG5cblxuXG5cblxuXG5cblxuXG5cbiJdfQ==