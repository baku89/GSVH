var API_KEY, GSVHyperlapse, getFollowedPath, pointOnLine,
  slice = [].slice;

Number.prototype.toRad = function() {
  return this * Math.PI / 180;
};

Number.prototype.toDeg = function() {
  return this * 180 / Math.PI;
};

API_KEY = "AIzaSyBQ2dzDfyF8Y0Dwe-Q6Jzx4_G62ANrTotQ";

pointOnLine = function(t, a, b) {
  var lat1, lat2, lng1, lng2, x, y;
  lat1 = a.lat().toRad();
  lng1 = a.lng().toRad();
  lat2 = b.lat().toRad();
  lng2 = b.lng().toRad();
  x = lat1 + t * (lat2 - lat1);
  y = lng1 + t * (lng2 - lng1);
  return new google.maps.LatLng(x.toDeg(), y.toDeg());
};

getFollowedPath = function(m, a, b) {
  var d, t;
  d = google.maps.geometry.spherical.computeDistanceBetween(a, b);
  if (m < 0 || d < m) {
    alert("error getFolowedPath");
  }
  t = m / d;
  return pointOnLine(t, a, b);
};

GSVHyperlapse = (function() {
  var _class;

  GSVHyperlapse.API_KEY = "AIzaSyBQ2dzDfyF8Y0Dwe-Q6Jzx4_G62ANrTotQ";

  GSVHyperlapse.DIST_BETWEEN_PTS = 5;

  GSVHyperlapse.MAX_PTS = 100;

  GSVHyperlapse.dirService = new google.maps.DirectionsService({});

  GSVHyperlapse.dirRegex = /dir\/([0-9.-]*),([0-9.-]*)\/([0-9.-]*),([0-9.-]*)\/@([0-9.-]*),([0-9.-]*),([0-9]*)z\/data=(.*)$/;

  GSVHyperlapse.dataRegex = /!1d([0-9.-]*)!2d([0-9.-]*)/g;

  GSVHyperlapse.dataLatLngRegex = /!1d([0-9.-]*)!2d([0-9.-]*)/;

  GSVHyperlapse.ldr = new GSVPANO.PanoLoader();

  GSVHyperlapse.ldrStack = [];

  _class = GSVHyperlapse;

  GSVHyperlapse.onError = function(err) {
    return alert("error");
  };

  GSVHyperlapse.onMessage = function() {
    return null;
  };

  GSVHyperlapse.onPanoramaLoad = function() {
    return null;
  };

  function GSVHyperlapse(args) {
    this.url = args.url;
    this.name = args.name;
    this.step = parseFloat(args.step);
    this.quality = args.quality;
    this.bCancel = false;
    if (args.travelMode === 'driving') {
      this.travelMode = google.maps.DirectionsTravelMode.DRIVING;
    } else if (args.travelMode === 'walking') {
      this.travelMode = google.maps.DirectionsTravelMode.WALKING;
    }
  }

  GSVHyperlapse.prototype.setMap = function(elm) {
    return this.mapElm = elm;
  };

  GSVHyperlapse.prototype.trace = function() {
    var args;
    args = 1 <= arguments.length ? slice.call(arguments, 0) : [];
    return console.log.apply(console, ["[" + this.name + "]"].concat(slice.call(args)));
  };

  GSVHyperlapse.prototype.traceBold = function(str) {
    return console.log("%c[" + this.name + "] " + str + " --------------------", "color:orange;font-weight:bold;");
  };

  GSVHyperlapse.prototype.create = function() {
    var _self, data, i, m, r, req, result, wp;
    this.traceBold("create");
    result = _class.dirRegex.exec(this.url);
    if (result == null) {
      alert("unco");
      _class.onMessage.call(this, "cannot parse url");
      return;
    }
    this.origin = new google.maps.LatLng(result[1], result[2]);
    this.destination = new google.maps.LatLng(result[3], result[4]);
    this.centroid = new google.maps.LatLng(result[5], result[6]);
    this.zoom = parseInt(result[7]);
    this.trace("origin: " + this.origin, "destination: " + this.destination);
    req = {
      origin: this.origin,
      destination: this.destination,
      travelMode: this.travelMode
    };
    this.waypoints = [];
    data = result[8];
    result = data.match(GSVHyperlapse.dataRegex);
    if (result != null) {
      for (i in result) {
        r = result[i];
        m = GSVHyperlapse.dataLatLngRegex.exec(r);
        wp = new google.maps.LatLng(m[2], m[1]);
        this.waypoints.push({
          location: wp.toString(),
          stopover: false
        });
      }
      this.trace("num of waypoints:", this.waypoints.length);
      req.waypoints = this.waypoints;
    }
    this.trace("request:", req);
    _self = this;
    this.map = new google.maps.Map(this.mapElm, {
      center: this.centroid,
      zoom: this.zoom,
      mapTypeId: google.maps.MapTypeId.ROADMAP
    });
    return GSVHyperlapse.dirService.route(req, function(res, status) {
      if (status === google.maps.DirectionsStatus.OK) {
        return _self.analyze(res);
      } else {
        return _class.onMessage.call(this, "cannot get route.");
      }
    });
  };

  GSVHyperlapse.prototype.analyze = function(res) {
    var a, b, d, i, j, k, legs, m, marker, path, pt, r, ref, ref1, ref2, route, self, totalDist;
    this.traceBold("analyze");
    _class.onMessage.call(this, "analyzing route..");
    this.trace(res.routes);
    this.rawPts = [];
    route = res.routes[0];
    path = route.overview_path;
    legs = route.legs;
    totalDist = 0;
    for (i = j = 0, ref = legs.length - 1; 0 <= ref ? j <= ref : j >= ref; i = 0 <= ref ? ++j : --j) {
      totalDist += legs[i].distance.value;
    }
    d = 0;
    r = 0;
    m = 0;
    a = b = null;
    this.trace("total distance:", totalDist);
    for (i = k = 0, ref1 = path.length - 2; 0 <= ref1 ? k <= ref1 : k >= ref1; i = 0 <= ref1 ? ++k : --k) {
      a = path[i];
      b = path[i + 1];
      d = google.maps.geometry.spherical.computeDistanceBetween(a, b);
      m = -r + this.step;
      if (d < m) {
        r += d;
      } else {
        while (m < d) {
          pt = getFollowedPath(m, a, b);
          this.rawPts.push(pt);
          m += this.step;
        }
        r = this.step - (m - d);
      }
    }
    this.trace("points:", this.rawPts.length);
    this.traceBold("fetch panoramas");
    this.map.fitBounds(route.bounds);
    ref2 = this.rawPts;
    for (i in ref2) {
      pt = ref2[i];
      marker = new google.maps.Marker({
        position: pt,
        map: this.map,
        title: "" + i
      });
    }
    this.loader = new GSVPANO.PanoLoader({
      zoom: this.quality
    });
    this.glsl = Glsl({
      canvas: document.createElement('canvas'),
      fragment: document.getElementById("pano-rotation").textContent,
      variables: {
        rotation: 0.0,
        pitch: 0.0,
        original: this.loader.canvas
      }
    });
    this.glsl.setSize(this.loader.width, this.loader.height);
    _class.onMessage.call(this, "composing panorama.. length:" + this.rawPts.length + " size:" + this.loader.width + "x" + this.loader.height);
    self = this;
    this.loader.onError = function(msg) {
      return _class.onMessage.call(this, "error");
    };
    this.loader.onPanoramaLoad = function() {
      return self.onLoadPanoImage.call(self);
    };
    this.prevId = "";
    this.index = 0;
    this.numPanorama = 0;
    return this.parsePoint();
  };

  GSVHyperlapse.prototype.parsePoint = function() {
    var self;
    if (this.bCancel) {
      return;
    }
    if (this.index === this.rawPts.length) {
      this.handleComplete();
      return;
    }
    self = this;
    this.trace(this.rawPts[this.index]);
    return this.loader.load(this.rawPts[this.index], function() {
      return self.onLoadPanoInfo.call(self);
    });
  };

  GSVHyperlapse.prototype.onLoadPanoInfo = function() {
    var id;
    id = this.loader.id;
    this.trace(this.loader.pitch, this.loader.rotation);
    if (this.prevId === id) {
      this.trace(this.index, " - skipped");
      this.index += 1;
      this.parsePoint();
    } else {
      this.trace(this.index, id);
      this.loader.composePanorama(id);
    }
    return this.prevId = id;
  };

  GSVHyperlapse.prototype.onLoadPanoImage = function() {
    var self;
    this.index += 1;
    this.glsl.set('rotation', this.loader.rotation);
    this.glsl.set('pitch', this.loader.pitch);
    this.glsl.syncAll();
    this.glsl.render();
    _class.onPanoramaLoad.call(this, this.glsl.canvas, this.index, this.rawPts.length);
    this.numPanorama += 1;
    self = this;
    return setTimeout(function() {
      return self.parsePoint();
    }, 100);
  };

  GSVHyperlapse.prototype.handleComplete = function() {
    this.traceBold("complete");
    this.trace("total panorama:", this.numPanorama);
    return _class.onMessage.call(this, "complete - total: " + this.numPanorama + ", duration: " + (this.numPanorama / 23.976));
  };

  return GSVHyperlapse;

})();

//# sourceMappingURL=data:application/json;base64,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QURVO0lBQUEsQ0FBWCxFQUVFLEdBRkYsRUFoQmdCO0VBQUEsQ0ExTmpCLENBQUE7O0FBQUEsMEJBZ1BBLGNBQUEsR0FBZ0IsU0FBQSxHQUFBO0FBQ2YsSUFBQSxJQUFDLENBQUEsU0FBRCxDQUFXLFVBQVgsQ0FBQSxDQUFBO0FBQUEsSUFDQSxJQUFDLENBQUEsS0FBRCxDQUFPLGlCQUFQLEVBQTBCLElBQUMsQ0FBQSxXQUEzQixDQURBLENBQUE7V0FHQSxNQUFNLENBQUMsU0FBUyxDQUFDLElBQWpCLENBQXNCLElBQXRCLEVBQXlCLG9CQUFBLEdBQXFCLElBQUMsQ0FBQSxXQUF0QixHQUFrQyxjQUFsQyxHQUErQyxDQUFDLElBQUMsQ0FBQSxXQUFELEdBQWUsTUFBaEIsQ0FBeEUsRUFKZTtFQUFBLENBaFBoQixDQUFBOzt1QkFBQTs7SUFqQ0QsQ0FBQSIsImZpbGUiOiJHU1ZIeXBlcmxhcHNlLmpzIiwic291cmNlUm9vdCI6Ii9zb3VyY2UvIiwic291cmNlc0NvbnRlbnQiOlsiTnVtYmVyLnByb3RvdHlwZS50b1JhZCA9ICgpIC0+IEAgKiBNYXRoLlBJIC8gMTgwXG5cbk51bWJlci5wcm90b3R5cGUudG9EZWcgPSAoKSAtPiBAICogMTgwIC8gTWF0aC5QSVxuXG5BUElfS0VZID0gXCJBSXphU3lCUTJkekRmeUY4WTBEd2UtUTZKeng0X0c2MkFOclRvdFFcIlxuXG5wb2ludE9uTGluZSA9ICh0LCBhLCBiKSAtPlxuXHRsYXQxID0gYS5sYXQoKS50b1JhZCgpXG5cdGxuZzEgPSBhLmxuZygpLnRvUmFkKClcblxuXHRsYXQyID0gYi5sYXQoKS50b1JhZCgpXG5cdGxuZzIgPSBiLmxuZygpLnRvUmFkKClcblxuXHR4ID0gbGF0MSArIHQgKiAobGF0MiAtIGxhdDEpO1xuXHR5ID0gbG5nMSArIHQgKiAobG5nMiAtIGxuZzEpO1xuXG5cdHJldHVybiBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHgudG9EZWcoKSwgeS50b0RlZygpKVxuXG5nZXRGb2xsb3dlZFBhdGggPSAobSwgYSwgYikgLT5cblx0ZCA9IGdvb2dsZS5tYXBzLmdlb21ldHJ5LnNwaGVyaWNhbC5jb21wdXRlRGlzdGFuY2VCZXR3ZWVuKGEsIGIpXG5cblx0aWYgbSA8IDAgfHwgZCA8IG1cblx0XHRhbGVydChcImVycm9yIGdldEZvbG93ZWRQYXRoXCIpXG5cblx0dCA9IG0gLyBkXG5cblx0cmV0dXJuIHBvaW50T25MaW5lKHQsIGEsIGIpXG5cblxuXG5jbGFzcyBHU1ZIeXBlcmxhcHNlXG5cblx0IyBjb25zdFxuXHRAQVBJX0tFWSA9IFwiQUl6YVN5QlEyZHpEZnlGOFkwRHdlLVE2Snp4NF9HNjJBTnJUb3RRXCJcblx0QERJU1RfQkVUV0VFTl9QVFMgPSA1XG5cdEBNQVhfUFRTID0gMTAwXG5cblx0IyBzdGF0aWMgdmFyXG5cdEBkaXJTZXJ2aWNlID0gbmV3IGdvb2dsZS5tYXBzLkRpcmVjdGlvbnNTZXJ2aWNlKHt9KVxuXHRAZGlyUmVnZXggPSAvZGlyXFwvKFswLTkuLV0qKSwoWzAtOS4tXSopXFwvKFswLTkuLV0qKSwoWzAtOS4tXSopXFwvQChbMC05Li1dKiksKFswLTkuLV0qKSwoWzAtOV0qKXpcXC9kYXRhPSguKikkL1xuXHRAZGF0YVJlZ2V4ID0gLyExZChbMC05Li1dKikhMmQoWzAtOS4tXSopL2dcblx0QGRhdGFMYXRMbmdSZWdleCA9IC8hMWQoWzAtOS4tXSopITJkKFswLTkuLV0qKS9cblxuXHQjIGxvYWRlclxuXHRAbGRyID0gbmV3IEdTVlBBTk8uUGFub0xvYWRlcigpXG5cdEBsZHJTdGFjayA9IFtdXG5cblx0X2NsYXNzID0gQFxuXG5cdCMgZXZlbnRcblx0QG9uRXJyb3IgPSAoZXJyKSAtPiBhbGVydChcImVycm9yXCIpXG5cdEBvbk1lc3NhZ2VcdD0gKCkgLT4gbnVsbFxuXHRAb25QYW5vcmFtYUxvYWQgXHQ9ICgpIC0+IG51bGxcblxuXHQjIGNvbnN0cnVjdG9yXG5cdGNvbnN0cnVjdG9yOiAoYXJncykgLT5cblx0XHRAdXJsID0gYXJncy51cmxcblx0XHRAbmFtZSA9IGFyZ3MubmFtZVxuXHRcdEBzdGVwID0gcGFyc2VGbG9hdCggYXJncy5zdGVwIClcblx0XHRAcXVhbGl0eSA9IGFyZ3MucXVhbGl0eVxuXHRcdEBiQ2FuY2VsID0gZmFsc2VcblxuXHRcdGlmIGFyZ3MudHJhdmVsTW9kZSA9PSAnZHJpdmluZydcblx0XHRcdEB0cmF2ZWxNb2RlID0gZ29vZ2xlLm1hcHMuRGlyZWN0aW9uc1RyYXZlbE1vZGUuRFJJVklOR1xuXHRcdGVsc2UgaWYgYXJncy50cmF2ZWxNb2RlID09ICd3YWxraW5nJ1xuXHRcdFx0QHRyYXZlbE1vZGUgPSBnb29nbGUubWFwcy5EaXJlY3Rpb25zVHJhdmVsTW9kZS5XQUxLSU5HXG5cblx0c2V0TWFwOiAoZWxtKSAtPlxuXHRcdEBtYXBFbG0gPSBlbG1cblxuXG5cdCMgbWV0aG9kc1xuXHR0cmFjZTogKGFyZ3MuLi4pIC0+XG5cdFx0Y29uc29sZS5sb2cgXCJbI3tAbmFtZX1dXCIsIGFyZ3MuLi5cblxuXHR0cmFjZUJvbGQ6IChzdHIpIC0+XG5cdFx0Y29uc29sZS5sb2cgXCIlY1sje0BuYW1lfV0gI3tzdHJ9IC0tLS0tLS0tLS0tLS0tLS0tLS0tXCIsIFwiY29sb3I6b3JhbmdlO2ZvbnQtd2VpZ2h0OmJvbGQ7XCJcblxuXHRjcmVhdGU6IC0+XG5cdFx0QHRyYWNlQm9sZCBcImNyZWF0ZVwiXG5cblx0XHQjIHBhcnNlIHVybFxuXHRcdHJlc3VsdCA9IF9jbGFzcy5kaXJSZWdleC5leGVjKCBAdXJsIClcblxuXHRcdGlmICFyZXN1bHQ/XG5cdFx0XHRhbGVydCBcInVuY29cIlxuXHRcdFx0X2NsYXNzLm9uTWVzc2FnZS5jYWxsIEAsIFwiY2Fubm90IHBhcnNlIHVybFwiXG5cdFx0XHRyZXR1cm5cblxuXHRcdEBvcmlnaW4gICAgICAgICA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoIHJlc3VsdFsxXSwgcmVzdWx0WzJdIClcblx0XHRAZGVzdGluYXRpb25cdD0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyggcmVzdWx0WzNdLCByZXN1bHRbNF0gKVxuXHRcdEBjZW50cm9pZCAgICAgICA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoIHJlc3VsdFs1XSwgcmVzdWx0WzZdIClcblx0XHRAem9vbSAgICAgICAgICAgPSBwYXJzZUludChyZXN1bHRbN10pXG5cblx0XHRAdHJhY2UgXCJvcmlnaW46IFwiICsgQG9yaWdpbiwgXCJkZXN0aW5hdGlvbjogXCIgKyBAZGVzdGluYXRpb25cblxuXHRcdHJlcSA9XG5cdFx0XHRvcmlnaW46IEBvcmlnaW5cblx0XHRcdGRlc3RpbmF0aW9uOiBAZGVzdGluYXRpb25cblx0XHRcdHRyYXZlbE1vZGU6IEB0cmF2ZWxNb2RlXG5cblxuXHRcdCMgcGFyc2Ugd2F5cG9pbnQgZnJvbSBkYXRhXG5cdFx0QHdheXBvaW50cyA9IFtdXG5cdFx0ZGF0YSAgID0gcmVzdWx0WzhdXG5cdFx0cmVzdWx0ID0gZGF0YS5tYXRjaCggR1NWSHlwZXJsYXBzZS5kYXRhUmVnZXggKVxuXG5cdFx0aWYgcmVzdWx0P1xuXHRcdFx0Zm9yIGksIHIgb2YgcmVzdWx0XG5cdFx0XHRcdG0gPSBHU1ZIeXBlcmxhcHNlLmRhdGFMYXRMbmdSZWdleC5leGVjKCByIClcblx0XHRcdFx0d3AgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKCBtWzJdLCBtWzFdIClcblx0XHRcdFx0QHdheXBvaW50cy5wdXNoXG5cdFx0XHRcdFx0bG9jYXRpb246IHdwLnRvU3RyaW5nKClcblx0XHRcdFx0XHRzdG9wb3ZlcjogZmFsc2VcblxuXHRcdFx0QHRyYWNlIFwibnVtIG9mIHdheXBvaW50czpcIiwgQHdheXBvaW50cy5sZW5ndGhcblx0XHRcdHJlcS53YXlwb2ludHMgPSBAd2F5cG9pbnRzXG5cblx0XHRAdHJhY2UgXCJyZXF1ZXN0OlwiLCByZXFcblxuXHRcdF9zZWxmID0gQFxuXG5cdFx0IyBjcmVhdGUgbWFwXG5cdFx0QG1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAgQG1hcEVsbSxcblx0XHRcdGNlbnRlcjogQGNlbnRyb2lkXG5cdFx0XHR6b29tOiBAem9vbVxuXHRcdFx0bWFwVHlwZUlkOiBnb29nbGUubWFwcy5NYXBUeXBlSWQuUk9BRE1BUFxuXG5cdFx0R1NWSHlwZXJsYXBzZS5kaXJTZXJ2aWNlLnJvdXRlIHJlcSwgKHJlcywgc3RhdHVzKSAtPlxuXHRcdFx0aWYgc3RhdHVzID09IGdvb2dsZS5tYXBzLkRpcmVjdGlvbnNTdGF0dXMuT0tcblx0XHRcdFx0X3NlbGYuYW5hbHl6ZShyZXMpXG5cdFx0XHRlbHNlXG5cdFx0XHRcdF9jbGFzcy5vbk1lc3NhZ2UuY2FsbCBALCBcImNhbm5vdCBnZXQgcm91dGUuXCJcblxuXG5cdGFuYWx5emU6IChyZXMpIC0+XG5cdFx0QHRyYWNlQm9sZCBcImFuYWx5emVcIlxuXG5cdFx0X2NsYXNzLm9uTWVzc2FnZS5jYWxsIEAsIFwiYW5hbHl6aW5nIHJvdXRlLi5cIlxuXG5cdFx0IyBnZXQgcG9pbnRzXG5cdFx0QHRyYWNlIHJlcy5yb3V0ZXNcblxuXHRcdEByYXdQdHMgPSBbXVxuXHRcdHJvdXRlID0gcmVzLnJvdXRlc1swXVxuXHRcdHBhdGggPSByb3V0ZS5vdmVydmlld19wYXRoXG5cdFx0bGVncyA9IHJvdXRlLmxlZ3NcblxuXHRcdHRvdGFsRGlzdCA9IDBcblx0XHRmb3IgaSBpbiBbMC4ubGVncy5sZW5ndGgtMV1cblx0XHRcdHRvdGFsRGlzdCArPSBsZWdzW2ldLmRpc3RhbmNlLnZhbHVlXG5cblx0XHRkID0gMCAjIGRpc3RhbmNlIGJldHdlZW4gYSBhbmQgYiAobSlcblx0XHRyID0gMCAjIGFsd2F5cyBtdXN0IGJlIDwgc3RlcFxuXHRcdG0gPSAwXG5cdFx0YSA9IGIgPSBudWxsXG5cblx0XHRAdHJhY2UgXCJ0b3RhbCBkaXN0YW5jZTpcIiwgdG90YWxEaXN0XG5cblx0XHQjIHJldHJpdmUgdG8gd2F5IHBvaW50c1xuXHRcdGZvciBpIGluIFswLi5wYXRoLmxlbmd0aC0yXVxuXG5cdFx0XHRhID0gcGF0aFtpXVxuXHRcdFx0YiA9IHBhdGhbaSsxXVxuXHRcdFx0ZCA9IGdvb2dsZS5tYXBzLmdlb21ldHJ5LnNwaGVyaWNhbC5jb21wdXRlRGlzdGFuY2VCZXR3ZWVuKGEsIGIpXG5cblx0XHRcdCMgb2Zmc2V0IC1yXG5cdFx0XHRtID0gLXIgKyBAc3RlcFxuXG5cdFx0XHRpZiBkIDwgbVxuXHRcdFx0XHRyICs9IGRcblx0XHRcdGVsc2Vcblx0XHRcdFx0IyBzdWJkaXZpZGVcblx0XHRcdFx0d2hpbGUgbSA8IGRcblx0XHRcdFx0XHRwdCA9IGdldEZvbGxvd2VkUGF0aChtLCBhLCBiKVxuXHRcdFx0XHRcdEByYXdQdHMucHVzaCggcHQgKVxuXHRcdFx0XHRcdG0gKz0gQHN0ZXBcblxuXHRcdFx0XHRyID0gQHN0ZXAgLSAobSAtIGQpXG5cblx0XHRAdHJhY2UgXCJwb2ludHM6XCIsIEByYXdQdHMubGVuZ3RoXG5cdFx0QHRyYWNlQm9sZCBcImZldGNoIHBhbm9yYW1hc1wiXG5cblx0XHQjIGZpdCBib3VuZCBhbmQgYWRkIHBpblxuXHRcdEBtYXAuZml0Qm91bmRzKCByb3V0ZS5ib3VuZHMgKVxuXHRcdGZvciBpLCBwdCBvZiBAcmF3UHRzXG5cdFx0XHRtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyXG5cdFx0XHRcdHBvc2l0aW9uOiBwdFxuXHRcdFx0XHRtYXA6IEBtYXBcblx0XHRcdFx0dGl0bGU6IFwiI3tpfVwiXG5cblx0XHQjIHN0YXJ0IHBhcnNlIHBvaW50XG5cdFx0QGxvYWRlciA9IG5ldyBHU1ZQQU5PLlBhbm9Mb2FkZXJcblx0XHRcdHpvb206IEBxdWFsaXR5XG5cblx0XHRAZ2xzbCA9IEdsc2xcblx0XHRcdGNhbnZhczogZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJylcblx0XHRcdGZyYWdtZW50OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBhbm8tcm90YXRpb25cIikudGV4dENvbnRlbnRcblx0XHRcdHZhcmlhYmxlczpcblx0XHRcdFx0cm90YXRpb246IDAuMFxuXHRcdFx0XHRwaXRjaDogMC4wXG5cdFx0XHRcdG9yaWdpbmFsOiBAbG9hZGVyLmNhbnZhc1xuXG5cdFx0QGdsc2wuc2V0U2l6ZShAbG9hZGVyLndpZHRoLCBAbG9hZGVyLmhlaWdodClcblxuXHRcdF9jbGFzcy5vbk1lc3NhZ2UuY2FsbCBALCBcImNvbXBvc2luZyBwYW5vcmFtYS4uIGxlbmd0aDoje0ByYXdQdHMubGVuZ3RofSBzaXplOiN7QGxvYWRlci53aWR0aH14I3tAbG9hZGVyLmhlaWdodH1cIlxuXHRcdFxuXHRcdHNlbGYgPSBAXG5cdFx0QGxvYWRlci5vbkVycm9yID0gKG1zZykgLT5cblx0XHRcdF9jbGFzcy5vbk1lc3NhZ2UuY2FsbCBALCBcImVycm9yXCJcblxuXHRcdEBsb2FkZXIub25QYW5vcmFtYUxvYWQgPSAtPlxuXHRcdFx0c2VsZi5vbkxvYWRQYW5vSW1hZ2UuY2FsbCBzZWxmXG5cblxuXHRcdEBwcmV2SWQgPSBcIlwiXG5cdFx0QGluZGV4ID0gMFxuXHRcdEBudW1QYW5vcmFtYSA9IDBcblxuXHRcdEBwYXJzZVBvaW50KClcblxuXHQjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdHBhcnNlUG9pbnQ6IC0+XG5cblx0XHRpZiBAYkNhbmNlbFxuXHRcdFx0cmV0dXJuXG5cblx0XHRpZiBAaW5kZXggPT0gQHJhd1B0cy5sZW5ndGhcblx0XHRcdEBoYW5kbGVDb21wbGV0ZSgpXG5cdFx0XHRyZXR1cm5cblx0XHRcblx0XHRzZWxmID0gQFxuXHRcdEB0cmFjZSBAcmF3UHRzW0BpbmRleF1cblx0XHRAbG9hZGVyLmxvYWQgQHJhd1B0c1tAaW5kZXhdLCAtPlxuXHRcdFx0c2VsZi5vbkxvYWRQYW5vSW5mby5jYWxsIHNlbGZcblxuXHRvbkxvYWRQYW5vSW5mbzogLT5cblx0XHRpZCA9IEBsb2FkZXIuaWRcblxuXHRcdEB0cmFjZSBAbG9hZGVyLnBpdGNoLCBAbG9hZGVyLnJvdGF0aW9uXG5cblx0XHRpZiBAcHJldklkID09IGlkXG5cdFx0XHRAdHJhY2UgQGluZGV4LCBcIiAtIHNraXBwZWRcIlxuXHRcdFx0QGluZGV4ICs9IDFcblx0XHRcdEBwYXJzZVBvaW50KClcblx0XHRlbHNlXG5cdFx0XHRAdHJhY2UgQGluZGV4LCBpZFxuXHRcdFx0QGxvYWRlci5jb21wb3NlUGFub3JhbWEoIGlkIClcblxuXHRcdEBwcmV2SWQgPSBpZFxuXG5cdG9uTG9hZFBhbm9JbWFnZTogLT5cblx0XHRAaW5kZXggKz0gMVxuXG5cdFx0QGdsc2wuc2V0KCdyb3RhdGlvbicsIEBsb2FkZXIucm90YXRpb24pXG5cdFx0QGdsc2wuc2V0KCdwaXRjaCcsIEBsb2FkZXIucGl0Y2gpXG5cdFx0QGdsc2wuc3luY0FsbCgpXG5cdFx0QGdsc2wucmVuZGVyKClcblxuXHRcdCNAdHJhY2UgXCJyb3RhdGlvblwiLCBAbG9hZGVyLnJvdGF0aW9uLCBcInBpdGNoXCIsIEBsb2FkZXIucGl0Y2hcblxuXHRcdF9jbGFzcy5vblBhbm9yYW1hTG9hZC5jYWxsIEAsIEBnbHNsLmNhbnZhcywgQGluZGV4LCBAcmF3UHRzLmxlbmd0aFxuXG5cdFx0IyBuZXh0IGZyYW1lXG5cdFx0QG51bVBhbm9yYW1hICs9IDFcblx0XHRcblx0XHRzZWxmID0gQFxuXHRcdHNldFRpbWVvdXQgLT5cblx0XHRcdHNlbGYucGFyc2VQb2ludCgpXG5cdFx0LCAxMDBcblxuXHQjIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0aGFuZGxlQ29tcGxldGU6IC0+XG5cdFx0QHRyYWNlQm9sZCBcImNvbXBsZXRlXCJcblx0XHRAdHJhY2UgXCJ0b3RhbCBwYW5vcmFtYTpcIiwgQG51bVBhbm9yYW1hXG5cblx0XHRfY2xhc3Mub25NZXNzYWdlLmNhbGwgQCwgXCJjb21wbGV0ZSAtIHRvdGFsOiAje0BudW1QYW5vcmFtYX0sIGR1cmF0aW9uOiAje0BudW1QYW5vcmFtYSAvIDIzLjk3Nn1cIlxuXG5cblxuXG5cblxuXG5cblxuXG4iXX0=