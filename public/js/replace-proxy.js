var $console, $progPano, $progSeq, $statPano, $statSeq, basename, decode, destDir, fileList, gsvh, gsvp, load, log, onComplete, sisyphus, srcDir, ss, startTime;

$console = null;

$progPano = null;

$statPano = null;

$progSeq = null;

$statSeq = null;

srcDir = "";

destDir = "";

fileList = null;

gsvh = null;

basename = null;

sisyphus = null;

gsvp = null;

startTime = null;

ss = new google.maps.StreetViewService();

log = function(str) {
  $console.append(str + "\n");
  return $console.scrollTop = $console.scrollHeight;
};

$(function() {
  $console = $('#console');
  $progPano = $('#prog-pano');
  $progSeq = $('#prog-seq');
  $statPano = $('#stat-pano');
  $statSeq = $('#stat-seq');
  sisyphus = $('#replace-proxy').sisyphus();
  $('#decode').on('click', decode);
  $('[name=file]').on('change', function() {
    $('[name=source]').val($('[name=file]').val());
    return sisyphus.saveAllData();
  });
  gsvp = new GSVPANO.PanoLoader({
    zoom: parseInt($('[name=zoom]').val())
  });
  return gsvp.onProgress = function(p) {
    $statPano.html(p + "%");
    return $progPano.val(p);
  };
});

decode = function() {
  var f, files;
  srcDir = $('[name=source]').val();
  if (srcDir === "") {
    alert("please select source directory");
    return;
  }
  files = fs.readdirSync(srcDir);
  fileList = (function() {
    var j, len, results;
    results = [];
    for (j = 0, len = files.length; j < len; j++) {
      f = files[j];
      if (/\.png$/.test(f)) {
        results.push(f);
      }
    }
    return results;
  })();
  basename = path.basename(srcDir);
  return load();
};

load = function() {
  var bChanged, bFlip, err, filename, flipCanvas, flipCtx, idx, img, loadImg, onLoadImg, outCanvas, outCtx, savePano, srcCanvas, srcCtx;
  startTime = new Date();
  destDir = (path.dirname(srcDir)) + "/" + basename + ".HQ";
  try {
    mkdirp.sync(destDir);
  } catch (_error) {
    err = _error;
    alert("Destination directory already exists. Please delete '" + destDir + "' to continue.");
  }
  img = new Image();
  srcCanvas = $('#src')[0];
  outCanvas = $('#out')[0];
  srcCtx = srcCanvas.getContext('2d');
  outCtx = outCanvas.getContext('2d');
  flipCanvas = document.createElement('canvas');
  flipCtx = flipCanvas.getContext('2d');
  bFlip = false;
  bChanged = false;
  idx = 0;
  filename = "";
  loadImg = function() {
    var elapsed;
    elapsed = ((new Date()) - startTime) / 1000 / 60;
    $statSeq.html("(" + (idx + 1) + "/" + fileList.length + ") " + (elapsed.toPrecision(2)) + "min elapsed");
    $progSeq.val((idx + 1) / fileList.length * 100);
    filename = fileList[idx];
    return img.src = "file:///" + srcDir + "/" + filename;
  };
  onLoadImg = function() {
    var dest, headingOffset, height, i, j, pano, pixel, pt, ref, width, x;
    width = img.width;
    height = img.height;
    srcCanvas.width = img.width;
    srcCanvas.height = img.height;
    srcCtx.drawImage(img, 0, 0);
    headingOffset = 0;
    x = 0;
    for (i = j = 0, ref = srcCanvas.width - 1; 0 <= ref ? j <= ref : j >= ref; i = 0 <= ref ? ++j : --j) {
      pixel = srcCtx.getImageData(i, 836, 1, 1).data;
      if (pixel[0] >= 128) {
        x = i;
        headingOffset = (x / srcCanvas.width) * 360;
        break;
      }
    }
    pt = {
      x: ((img.width + x) - 3) % img.width,
      y: 843
    };
    pixel = srcCtx.getImageData(pt.x, pt.y, 1, 1).data;
    if (pixel[0] > 128) {
      bFlip = true;
      x = img.width - (x + 12);
      headingOffset = (x / srcCanvas.width) * 360;
    } else {
      bFlip = false;
    }
    flipCanvas.width = img.width;
    flipCanvas.height = img.height;
    if (bFlip) {
      flipCtx.save();
      flipCtx.scale(-1, 1);
      flipCtx.translate(img.width, 0);
      flipCtx.drawImage(img, 0, 0);
      flipCtx.restore();
    } else {
      flipCtx.drawImage(img, 0, 0);
    }
    srcCtx.drawImage(flipCanvas, 0, height - TAG_HEIGHT, width, TAG_HEIGHT, -x, height - TAG_HEIGHT, width, TAG_HEIGHT);
    srcCtx.drawImage(flipCanvas, 0, height - TAG_HEIGHT, width, TAG_HEIGHT, -x + width, height - TAG_HEIGHT, width, TAG_HEIGHT);
    pano = CanvasMatrixCode.decode(srcCanvas, 0, srcCanvas.height - TAG_HEIGHT + 10, 1664, TAG_HEIGHT - 10);
    if (pano === null) {
      dest = destDir + "/" + filename;
      saveCanvas(srcCanvas, dest);
      setTimeout(function() {
        if (++idx < fileList.length) {
          return loadImg();
        } else {
          return onComplete();
        }
      }, 1);
      return;
    }
    return ss.getPanoramaById(pano.id, function(data, status) {
      var lat, latLng, lng, radius, result, searchNearestPano;
      if (status === google.maps.StreetViewStatus.OK) {
        bChanged = false;
        return gsvp.composePanorama(pano.id, pano.heading + headingOffset);
      } else {
        console.log("invalid pano id: " + pano.id);
        bChanged = true;
        result = /([\-0-9.]+), ([\-0-9.]+)/.exec(pano.latLng);
        lat = result[1];
        lng = result[2];
        latLng = new google.maps.LatLng(lat, lng);
        radius = 1;
        searchNearestPano = function() {
          return ss.getPanoramaByLocation(latLng, radius, function(data, status) {
            var id;
            if (status === google.maps.StreetViewStatus.OK) {
              id = data.location.pano;
              console.log("nearest pano: " + pano.id + " -> " + id + ", radius: " + radius);
              return gsvp.composePanorama(id, pano.heading + headingOffset);
            } else {
              radius++;
              return setTimeout(searchNearestPano, 500);
            }
          });
        };
        return searchNearestPano();
      }
    });
  };
  savePano = function() {
    var dest;
    console.log("save pano");
    outCanvas.width = gsvp.width;
    outCanvas.height = (img.height / img.width) * gsvp.width;
    outCtx.fillStyle = '#000000';
    outCtx.fillRect(0, 0, outCanvas.width, outCanvas.height);
    if (bFlip) {
      console.log("fliped");
      outCtx.save();
      outCtx.scale(-1, 1);
      outCtx.translate(gsvp.canvas.width);
    }
    outCtx.drawImage(gsvp.canvas, 0, 0);
    if (bFlip) {
      outCtx.restore();
    }
    outCtx.save();
    outCtx.translate(0, gsvp.canvas.height * 2);
    outCtx.scale(1, -1);
    outCtx.drawImage(gsvp.canvas, 0, 0);
    outCtx.restore();
    outCtx.drawImage(img, 0, img.height - TAG_HEIGHT, img.width, TAG_HEIGHT, 0, outCanvas.height - TAG_HEIGHT, img.width, TAG_HEIGHT);
    dest = destDir + "/" + filename;
    saveCanvas(outCanvas, dest);
    if (bChanged) {
      outCtx.fillStyle = '#ff0000';
      coutCtx.fillRect(outCanvas.width - 10, outCanvas.height - 10, 10, 10);
    }
    if (++idx < fileList.length) {
      return loadImg();
    } else {
      return onComplete();
    }
  };
  img.onload = onLoadImg;
  gsvp.onPanoramaLoad = savePano;
  return loadImg();
};

onComplete = function() {
  return setTimeout(function() {
    fs.renameSync(srcDir, srcDir + ".proxy");
    fs.renameSync(destDir, srcDir);
    return notifier.notify({
      title: "Proxy Replacer",
      message: "All done!",
      sound: true
    });
  }, 2000);
};

//# sourceMappingURL=data:application/json;base64,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Q0FsRVAsQ0FBQTs7QUFBQSxVQWtSQSxHQUFhLFNBQUEsR0FBQTtTQUVaLFVBQUEsQ0FBVyxTQUFBLEdBQUE7QUFDVixJQUFBLEVBQUUsQ0FBQyxVQUFILENBQWMsTUFBZCxFQUF5QixNQUFELEdBQVEsUUFBaEMsQ0FBQSxDQUFBO0FBQUEsSUFDQSxFQUFFLENBQUMsVUFBSCxDQUFjLE9BQWQsRUFBdUIsTUFBdkIsQ0FEQSxDQUFBO1dBR0EsUUFBUSxDQUFDLE1BQVQsQ0FDQztBQUFBLE1BQUEsS0FBQSxFQUFPLGdCQUFQO0FBQUEsTUFDQSxPQUFBLEVBQVMsV0FEVDtBQUFBLE1BRUEsS0FBQSxFQUFPLElBRlA7S0FERCxFQUpVO0VBQUEsQ0FBWCxFQVFFLElBUkYsRUFGWTtBQUFBLENBbFJiLENBQUEiLCJmaWxlIjoicmVwbGFjZS1wcm94eS5qcyIsInNvdXJjZVJvb3QiOiIvc291cmNlLyIsInNvdXJjZXNDb250ZW50IjpbIiRjb25zb2xlID0gbnVsbFxuJHByb2dQYW5vID0gbnVsbFxuJHN0YXRQYW5vID0gbnVsbFxuJHByb2dTZXEgPSBudWxsXG4kc3RhdFNlcSA9IG51bGxcblxuc3JjRGlyID0gXCJcIlxuZGVzdERpciA9IFwiXCJcbmZpbGVMaXN0ID0gbnVsbFxuXG5nc3ZoID0gbnVsbFxuXG5iYXNlbmFtZSA9IG51bGxcbnNpc3lwaHVzID0gbnVsbFxuXG5nc3ZwID0gbnVsbFxuXG5zdGFydFRpbWUgPSBudWxsXG5cbnNzID0gbmV3IGdvb2dsZS5tYXBzLlN0cmVldFZpZXdTZXJ2aWNlKClcblxubG9nID0gKHN0cikgLT5cblx0JGNvbnNvbGUuYXBwZW5kKFwiI3tzdHJ9XFxuXCIpXG5cdCRjb25zb2xlLnNjcm9sbFRvcCA9ICRjb25zb2xlLnNjcm9sbEhlaWdodFxuXG4kIC0+XG5cdCRjb25zb2xlID0gJCgnI2NvbnNvbGUnKVxuXHQkcHJvZ1Bhbm8gPSAkKCcjcHJvZy1wYW5vJylcblx0JHByb2dTZXEgPSAkKCcjcHJvZy1zZXEnKVxuXHQkc3RhdFBhbm8gPSAkKCcjc3RhdC1wYW5vJylcblx0JHN0YXRTZXEgPSAkKCcjc3RhdC1zZXEnKVxuXG5cdHNpc3lwaHVzID0gJCgnI3JlcGxhY2UtcHJveHknKS5zaXN5cGh1cygpXG5cblx0JCgnI2RlY29kZScpLm9uICdjbGljaycsIGRlY29kZVxuXG5cdCQoJ1tuYW1lPWZpbGVdJykub24gJ2NoYW5nZScsIC0+XG5cdFx0JCgnW25hbWU9c291cmNlXScpXG5cdFx0XHQudmFsKCAkKCdbbmFtZT1maWxlXScpLnZhbCgpIClcblx0XHRzaXN5cGh1cy5zYXZlQWxsRGF0YSgpXG5cblx0Z3N2cCA9IG5ldyBHU1ZQQU5PLlBhbm9Mb2FkZXJcblx0XHR6b29tOiBwYXJzZUludCggJCgnW25hbWU9em9vbV0nKS52YWwoKSApXG5cblx0Z3N2cC5vblByb2dyZXNzID0gKHApIC0+XG5cdFx0JHN0YXRQYW5vLmh0bWwoXCIje3B9JVwiKVxuXHRcdCRwcm9nUGFuby52YWwoIHAgKVxuXG5cblxuIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuZGVjb2RlID0gLT5cblx0c3JjRGlyID0gJCgnW25hbWU9c291cmNlXScpLnZhbCgpXG5cblx0aWYgc3JjRGlyID09IFwiXCJcblx0XHRhbGVydCBcInBsZWFzZSBzZWxlY3Qgc291cmNlIGRpcmVjdG9yeVwiXG5cdFx0cmV0dXJuXG5cblx0ZmlsZXMgPSBmcy5yZWFkZGlyU3luYyhzcmNEaXIpXG5cblx0ZmlsZUxpc3QgPSAoZiBmb3IgZiBpbiBmaWxlcyB3aGVuIC9cXC5wbmckLy50ZXN0KGYpKVxuXHRiYXNlbmFtZSA9IHBhdGguYmFzZW5hbWUoIHNyY0RpciApXG5cblx0bG9hZCgpXG5cbiMtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmxvYWQgPSAoKSAtPlxuXG5cdHN0YXJ0VGltZSA9IG5ldyBEYXRlKClcblxuXHQjIG1ha2UgbmV3IGRpcmVjdG9yeVxuXHRkZXN0RGlyID0gXCIje3BhdGguZGlybmFtZShzcmNEaXIpfS8je2Jhc2VuYW1lfS5IUVwiXG5cdHRyeVxuXHRcdG1rZGlycC5zeW5jKGRlc3REaXIpXG5cdFx0I2ZzLm1rZGlyU3luYyhkZXN0RGlyKVxuXHRjYXRjaCBlcnJcblx0XHRhbGVydChcIkRlc3RpbmF0aW9uIGRpcmVjdG9yeSBhbHJlYWR5IGV4aXN0cy4gUGxlYXNlIGRlbGV0ZSAnI3tkZXN0RGlyfScgdG8gY29udGludWUuXCIpXG5cblx0aW1nID0gbmV3IEltYWdlKClcblxuXHRzcmNDYW52YXMgPSAkKCcjc3JjJylbMF1cblx0b3V0Q2FudmFzID0gJCgnI291dCcpWzBdXG5cblx0c3JjQ3R4ID0gc3JjQ2FudmFzLmdldENvbnRleHQoJzJkJylcblx0b3V0Q3R4ID0gb3V0Q2FudmFzLmdldENvbnRleHQoJzJkJylcblxuXHRmbGlwQ2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJylcblx0ZmxpcEN0eCA9IGZsaXBDYW52YXMuZ2V0Q29udGV4dCgnMmQnKVxuXG5cdGJGbGlwID0gZmFsc2Vcblx0YkNoYW5nZWQgPSBmYWxzZVxuXG5cdGlkeCA9IDBcblx0ZmlsZW5hbWUgPSBcIlwiXG5cblx0Iy0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdCMgMS4gbG9hZCBpbWFnZVxuXHRsb2FkSW1nID0gKCkgLT5cblx0XHRlbGFwc2VkID0gKCgobmV3IERhdGUoKSkgLSBzdGFydFRpbWUpIC8gMTAwMCAvIDYwKVxuXHRcdCRzdGF0U2VxLmh0bWwoXCIoI3tpZHgrMX0vI3tmaWxlTGlzdC5sZW5ndGh9KSAje2VsYXBzZWQudG9QcmVjaXNpb24oMil9bWluIGVsYXBzZWRcIilcblx0XHQkcHJvZ1NlcS52YWwoIChpZHgrMSkgLyBmaWxlTGlzdC5sZW5ndGggKiAxMDAgKVxuXG5cblx0XHRmaWxlbmFtZSA9IGZpbGVMaXN0W2lkeF1cblx0XHRpbWcuc3JjID0gXCJmaWxlOi8vLyN7c3JjRGlyfS8je2ZpbGVuYW1lfVwiXG5cblx0Iy0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdCMgMi4gcmVhZCBtYXRyaXggY29kZSBhbmQgc2V0dXAgZ3N2aCBhbmQgcnVuIGNvbXBvc2UoKVxuXHRvbkxvYWRJbWcgPSAtPlxuXG5cdFx0d2lkdGggPSBpbWcud2lkdGhcblx0XHRoZWlnaHQgPSBpbWcuaGVpZ2h0XG5cblx0XHRzcmNDYW52YXMud2lkdGggPSBpbWcud2lkdGhcblx0XHRzcmNDYW52YXMuaGVpZ2h0ID0gaW1nLmhlaWdodFxuXG5cblx0XHRzcmNDdHguZHJhd0ltYWdlKGltZywgMCwgMClcblxuXHRcdCMgcmVhZCBoZWFkaW5nIG9mZnNldFxuXHRcdGhlYWRpbmdPZmZzZXQgPSAwXG5cdFx0eCA9IDBcblx0XHRmb3IgaSBpbiBbMC4uc3JjQ2FudmFzLndpZHRoLTFdXG5cdFx0XHRwaXhlbCA9IHNyY0N0eC5nZXRJbWFnZURhdGEoaSwgODM2LCAxLCAxKS5kYXRhXG5cdFx0XHRpZiBwaXhlbFswXSA+PSAxMjhcblx0XHRcdFx0eCA9IGlcblx0XHRcdFx0aGVhZGluZ09mZnNldCA9ICh4IC8gc3JjQ2FudmFzLndpZHRoKSAqIDM2MFxuXHRcdFx0XHRicmVha1xuXG5cdFx0IyByZWFkIGlmIGZsaXBlZFxuXHRcdHB0ID1cblx0XHRcdHg6ICgoaW1nLndpZHRoICsgeCkgLSAzKSAlIGltZy53aWR0aFxuXHRcdFx0eTogODQzXG5cblx0XHRwaXhlbCA9IHNyY0N0eC5nZXRJbWFnZURhdGEocHQueCwgcHQueSwgMSwgMSkuZGF0YVxuXHRcdGlmIHBpeGVsWzBdID4gMTI4XG5cdFx0XHRiRmxpcCA9IHRydWVcblx0XHRcdHggPSBpbWcud2lkdGggLSAoeCsxMilcblx0XHRcdGhlYWRpbmdPZmZzZXQgPSAoeCAvIHNyY0NhbnZhcy53aWR0aCkgKiAzNjBcblx0XHRlbHNlXG5cdFx0XHRiRmxpcCA9IGZhbHNlXG5cblx0XHQjIGZpeCB0YWcgb2Zmc2V0XG5cdFx0ZmxpcENhbnZhcy53aWR0aCA9IGltZy53aWR0aFxuXHRcdGZsaXBDYW52YXMuaGVpZ2h0ID0gaW1nLmhlaWdodFxuXG5cdFx0aWYgYkZsaXBcblx0XHRcdGZsaXBDdHguc2F2ZSgpXG5cdFx0XHRmbGlwQ3R4LnNjYWxlKC0xLCAxKVxuXHRcdFx0ZmxpcEN0eC50cmFuc2xhdGUoaW1nLndpZHRoLCAwKVxuXHRcdFx0ZmxpcEN0eC5kcmF3SW1hZ2UoIGltZywgMCwgMCApXG5cdFx0XHRmbGlwQ3R4LnJlc3RvcmUoKVxuXG5cdFx0ZWxzZVxuXHRcdFx0ZmxpcEN0eC5kcmF3SW1hZ2UoIGltZywgMCwgMCApXG5cblxuXHRcdHNyY0N0eC5kcmF3SW1hZ2UoZmxpcENhbnZhcyxcblx0XHRcdDAsIGhlaWdodCAtIFRBR19IRUlHSFQsIHdpZHRoLCBUQUdfSEVJR0hULFxuXHRcdFx0LXgsIGhlaWdodCAtIFRBR19IRUlHSFQsIHdpZHRoLCBUQUdfSEVJR0hUKVxuXHRcdHNyY0N0eC5kcmF3SW1hZ2UoZmxpcENhbnZhcyxcblx0XHRcdDAsIGhlaWdodCAtIFRBR19IRUlHSFQsIHdpZHRoLCBUQUdfSEVJR0hULFxuXHRcdFx0LXggKyB3aWR0aCwgaGVpZ2h0IC0gVEFHX0hFSUdIVCwgd2lkdGgsIFRBR19IRUlHSFQpXG5cblx0XHQjIGRlY29kZSBwYW5vIG1hdHJpeCBjb2RlXG5cdFx0cGFubyA9IENhbnZhc01hdHJpeENvZGUuZGVjb2RlKFxuXHRcdFx0c3JjQ2FudmFzLFxuXHRcdFx0MCxcblx0XHRcdHNyY0NhbnZhcy5oZWlnaHQgLSBUQUdfSEVJR0hUICsgMTAsXG5cdFx0XHQxNjY0LCBUQUdfSEVJR0hUIC0gMTApXG5cblx0XHRpZiBwYW5vID09IG51bGxcblx0XHRcdGRlc3QgPSBcIiN7ZGVzdERpcn0vI3tmaWxlbmFtZX1cIlxuXHRcdFx0c2F2ZUNhbnZhcyggc3JjQ2FudmFzLCBkZXN0IClcblxuXHRcdFx0c2V0VGltZW91dCAtPlxuXHRcdFx0XHRpZiArK2lkeCA8IGZpbGVMaXN0Lmxlbmd0aFxuXHRcdFx0XHRcdGxvYWRJbWcoKVxuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0b25Db21wbGV0ZSgpXG5cdFx0XHQsIDFcblx0XHRcdHJldHVyblxuXG5cdFx0IyBjaGVjayBpZiB0aGUgcGFubyBpZCBpcyB2YWxpZFxuXHRcdHNzLmdldFBhbm9yYW1hQnlJZCBwYW5vLmlkLCAoZGF0YSwgc3RhdHVzKSAtPlxuXG5cdFx0XHRpZiBzdGF0dXMgPT0gZ29vZ2xlLm1hcHMuU3RyZWV0Vmlld1N0YXR1cy5PSyBcblx0XHRcdFx0IyBnZW5lcmF0ZSBwYW5vXG5cdFx0XHRcdGJDaGFuZ2VkID0gZmFsc2Vcblx0XHRcdFx0Z3N2cC5jb21wb3NlUGFub3JhbWEoIHBhbm8uaWQsIHBhbm8uaGVhZGluZyArIGhlYWRpbmdPZmZzZXQgKVxuXHRcdFx0ZWxzZVxuXHRcdFx0XHRjb25zb2xlLmxvZyBcImludmFsaWQgcGFubyBpZDogI3twYW5vLmlkfVwiXG5cdFx0XHRcdGJDaGFuZ2VkID0gdHJ1ZVxuXG5cdFx0XHRcdHJlc3VsdCA9IC8oW1xcLTAtOS5dKyksIChbXFwtMC05Ll0rKS8uZXhlYyhwYW5vLmxhdExuZylcblx0XHRcdFx0bGF0ID0gcmVzdWx0WzFdXG5cdFx0XHRcdGxuZyA9IHJlc3VsdFsyXVxuXHRcdFx0XHRsYXRMbmcgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxhdCwgbG5nKVxuXG5cdFx0XHRcdCMgc2VhcmNoIG5lYXJlc3QgcGFub1xuXHRcdFx0XHRyYWRpdXMgPSAxXG5cblx0XHRcdFx0c2VhcmNoTmVhcmVzdFBhbm8gPSAtPlxuXHRcdFx0XHRcdHNzLmdldFBhbm9yYW1hQnlMb2NhdGlvbiBsYXRMbmcsIHJhZGl1cywgKGRhdGEsIHN0YXR1cykgLT5cblx0XHRcdFx0XHRcdGlmIHN0YXR1cyA9PSBnb29nbGUubWFwcy5TdHJlZXRWaWV3U3RhdHVzLk9LXG5cdFx0XHRcdFx0XHRcdGlkID0gZGF0YS5sb2NhdGlvbi5wYW5vXG5cdFx0XHRcdFx0XHRcdGNvbnNvbGUubG9nIFwibmVhcmVzdCBwYW5vOiAje3Bhbm8uaWR9IC0+ICN7aWR9LCByYWRpdXM6ICN7cmFkaXVzfVwiXG5cdFx0XHRcdFx0XHRcdGdzdnAuY29tcG9zZVBhbm9yYW1hKCBpZCwgcGFuby5oZWFkaW5nICsgaGVhZGluZ09mZnNldCApXG5cdFx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0XHRcdHJhZGl1cysrXG5cdFx0XHRcdFx0XHRcdHNldFRpbWVvdXQoc2VhcmNoTmVhcmVzdFBhbm8sIDUwMClcblxuXHRcdFx0XHRzZWFyY2hOZWFyZXN0UGFubygpXG5cblx0Iy0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdCMgMy4gbWVyZ2Ugd2l0aCBtYXRyaXggY29kZSBhbmQgc2F2ZVxuXHRzYXZlUGFubyA9IC0+XG5cdFx0Y29uc29sZS5sb2cgXCJzYXZlIHBhbm9cIlxuXG5cdFx0b3V0Q2FudmFzLndpZHRoID0gZ3N2cC53aWR0aFxuXHRcdG91dENhbnZhcy5oZWlnaHQgPSAoaW1nLmhlaWdodCAvIGltZy53aWR0aCkgKiBnc3ZwLndpZHRoXG5cblx0XHQjIGRyYXdcblx0XHRvdXRDdHguZmlsbFN0eWxlID0gJyMwMDAwMDAnXG5cdFx0b3V0Q3R4LmZpbGxSZWN0KDAsIDAsIG91dENhbnZhcy53aWR0aCwgb3V0Q2FudmFzLmhlaWdodClcblxuXG5cdFx0aWYgYkZsaXBcblx0XHRcdGNvbnNvbGUubG9nIFwiZmxpcGVkXCJcblx0XHRcdG91dEN0eC5zYXZlKClcblx0XHRcdG91dEN0eC5zY2FsZSgtMSwgMSlcblx0XHRcdG91dEN0eC50cmFuc2xhdGUoZ3N2cC5jYW52YXMud2lkdGgpXG5cblx0XHRvdXRDdHguZHJhd0ltYWdlKGdzdnAuY2FudmFzLCAwLCAwKVxuXG5cdFx0aWYgYkZsaXBcblx0XHRcdG91dEN0eC5yZXN0b3JlKClcblxuXHRcdCMgZmlscCBcblx0XHRvdXRDdHguc2F2ZSgpXG5cdFx0b3V0Q3R4LnRyYW5zbGF0ZSgwLCBnc3ZwLmNhbnZhcy5oZWlnaHQgKiAyKVxuXHRcdG91dEN0eC5zY2FsZSgxLCAtMSlcblx0XHRvdXRDdHguZHJhd0ltYWdlKGdzdnAuY2FudmFzLCAwLCAwKVxuXHRcdG91dEN0eC5yZXN0b3JlKClcblxuXHRcdCMgY29kZVxuXHRcdG91dEN0eC5kcmF3SW1hZ2UoXG5cdFx0XHRpbWcsXG5cdFx0XHQwLCBpbWcuaGVpZ2h0IC0gVEFHX0hFSUdIVCwgXHRcdGltZy53aWR0aCwgVEFHX0hFSUdIVCxcblx0XHRcdDAsIG91dENhbnZhcy5oZWlnaHQgLSBUQUdfSEVJR0hULCBcdGltZy53aWR0aCwgVEFHX0hFSUdIVClcblxuXHRcdGRlc3QgPSBcIiN7ZGVzdERpcn0vI3tmaWxlbmFtZX1cIlxuXHRcdHNhdmVDYW52YXMoIG91dENhbnZhcywgZGVzdCApXG5cblx0XHQjIGNoYW5nZWRcblx0XHRpZiBiQ2hhbmdlZFxuXHRcdFx0b3V0Q3R4LmZpbGxTdHlsZSA9ICcjZmYwMDAwJ1xuXHRcdFx0Y291dEN0eC5maWxsUmVjdChvdXRDYW52YXMud2lkdGgtMTAsIG91dENhbnZhcy5oZWlnaHQtMTAsIDEwLCAxMClcblxuXHRcdCMgbmV4dFxuXHRcdGlmICsraWR4IDwgZmlsZUxpc3QubGVuZ3RoXG5cdFx0XHRsb2FkSW1nKClcblx0XHRlbHNlXG5cdFx0XHRvbkNvbXBsZXRlKClcblxuXHQjLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0IyB0cmlnZ2VyXG5cdGltZy5vbmxvYWQgPSBvbkxvYWRJbWdcblx0Z3N2cC5vblBhbm9yYW1hTG9hZCA9IHNhdmVQYW5vXG5cblx0bG9hZEltZygpXG5cblxuIy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxub25Db21wbGV0ZSA9IC0+XG5cblx0c2V0VGltZW91dCAtPlxuXHRcdGZzLnJlbmFtZVN5bmMoc3JjRGlyLCBcIiN7c3JjRGlyfS5wcm94eVwiKVxuXHRcdGZzLnJlbmFtZVN5bmMoZGVzdERpciwgc3JjRGlyKVxuXG5cdFx0bm90aWZpZXIubm90aWZ5XG5cdFx0XHR0aXRsZTogXCJQcm94eSBSZXBsYWNlclwiXG5cdFx0XHRtZXNzYWdlOiBcIkFsbCBkb25lIVwiXG5cdFx0XHRzb3VuZDogdHJ1ZVxuXHQsIDIwMDBcblxuXG5cdFxuXG5cbiJdfQ==