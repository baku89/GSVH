<!DOCTYPE html>
<!-- -->
<!-- island https://www.google.co.jp/maps/dir/-3.8627398,-32.4155203/-3.8623602,-32.4207532/@-3.8621801,-32.4174875,17z/data=!4m2!4m1!3e2-->
<!-- fiyorudo https://www.google.com/maps/dir/45.2225007,6.1375653/45.2246012,6.1391705/@45.2226213,6.1340457,16z/data=!3m1!4b1!4m2!4m1!3e0?hl=ja-->
<!-- aqua line https://www.google.co.jp/maps/dir/35.4626822,139.8760935/35.463556,139.8765012/@35.4638422,139.8727434,17z/data=!3m1!4b1!4m2!4m1!3e0-->
<html>
  <head>
    <title>GSV Generator</title>
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&amp;sensor=false"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r70/three.min.js"></script>
    <script src="js/lib/GSVPano.js"></script>
    <script src="js/lib/glsl.min.js"></script>
    <!--script(src='js/lib/hyperlapse.min.js')-->
    <script src="js/canvas-exporter.js"></script>
    <script src="js/GSVHyperlapse.js"></script>
    <script src="js/gsv-generator.js"></script>
    <link rel="stylesheet" href="css/simple-gui.css">
    <style>
      @font-face {
        font-family: 'OCR';
        src: url('./assets/OCRAStd.otf') format('opentype');
      }
      
    </style>
    <script id="pano-rotation" type="x-shader/x-fragment">#ifdef GL_ES
precision highp float;
#endif

#define PI 3.14159265358979323846264
#define PI_2 (PI * 2.0)
#define TAG_HEIGHT 40.0

uniform vec2 resolution;
uniform sampler2D original;
uniform sampler2D tag;
uniform float pitch;
uniform float rotation;

void main (void) {

	if ( gl_FragCoord.y < TAG_HEIGHT - 2.0) {

		vec2 p = vec2(
			gl_FragCoord.x / resolution.x,
			gl_FragCoord.y / TAG_HEIGHT
		);

		gl_FragColor = texture2D( tag, p );

	} else {
		vec2 op = (gl_FragCoord.xy - vec2(0.0, TAG_HEIGHT)) / (resolution.xy - vec2(0.0, TAG_HEIGHT));

		// cab rotation
		vec2 p = vec2(fract(op.x + rotation / PI_2), clamp(op.y, 0.0, 1.0));

		// //(u,v) -> (θ,φ)
		// p = vec2(
		// 	p.x * PI_2,
		// 	PI * (p.y - 0.5)
		// );

		

		// // (θ,φ) -> (x, y, z)
		// vec3 c = vec3(
		// 	cos(p.x) * cos(p.y),
		// 	sin(p.x) * cos(p.y),
		// 	sin(p.y)
		// );


		

		// // (x, y, x) -rot-> (x', y', z')
		// c = vec3(
		// 	cos(pitch) * c.x - sin(pitch) * c.z,
		// 	c.y,
		// 	sin(pitch) * c.x + cos(pitch) * c.z
		// );

		// // (x', y', z') -> (θ',φ')
		// p = vec2(
		// 	atan(c.y, c.x),
		// 	atan(c.z, length(c.xy))
		// );

		// //gl_FragColor = vec4(c.x, c.y, c.z, 1.0);


		// // (θ',φ') -> (u',v')
		// p = vec2(
		// 	p.x / PI_2,
		// 	p.y / PI + 0.5
		// );

		//p = fract(p);

		vec4 color = texture2D(original, p);

		// vec2 dir = vec2(rotation / PI_2, pitch / PI + 0.5);
		// if (distance(p, dir) < 0.01) {
		// 	color = vec4(1.0, 0.0, 0.0, 1.0);
		// 	//p = vec2(0.0, 0.0);
		// }

		//gl_FragColor = vec4(p.x, p.y, 0.0, 1.0);

		// gl_FragColor = vec4(c.x, c.y, c.z, 1.0);
		gl_FragColor = color;
	}
}
    </script>
  </head>
  <body>
    <nav>
      <h1>GSV Generator</h1>
      <dl>
        <dt>name</dt>
        <dd>
          <input id="name" type="text" value="island">
        </dd>
        <dt>exporting dir (rel)</dt>
        <dd>
          <input id="dir" type="text" value="../../gsv">
        </dd>
        <dt>route url</dt>
        <dd>
          <input id="url" type="url" value="https://www.google.co.jp/maps/dir/-3.8627398,-32.4155203/-3.8623602,-32.4207532/@-3.8621801,-32.4174875,17z/data=!4m2!4m1!3e2">
        </dd>
        <dt>travel mode</dt>
        <dd>
          <input id="travel-1" type="radio" name="travel" value="driving" checked>
          <label for="travel-1">driving</label>
          <input id="travel-2" type="radio" name="travel" value="walking">
          <label for="travel-2">walking</label><br>
        </dd>
        <dt>heading</dt>
        <dd>
          <input id="heading-1" type="radio" name="heading" value="forward">
          <label for="heading-1">forward </label><br>
          <input id="heading-2" type="radio" name="heading" value="latlng">
          <label for="heading-2">latlng</label><br>
          <input id="heading-3" type="radio" name="heading" value="north" checked>
          <label for="heading-3">north</label><br>
        </dd>
        <dt>[optional] lookat url
          <input id="lookat" type="text" data-onchecked="#heading-2">
        </dt>
        <dt>zoom(proxy=2, rendring=6)</dt>
        <dd>
          <input id="zoom" type="number" value="2">
        </dd>
        <dt>step(m)</dt>
        <dd>
          <input id="step" type="number" value="10">
        </dd>
        <dt>sv search radius(m)</dt>
        <dd>
          <input id="search-radius" type="number" value="5">
        </dd>
      </dl>
      <button id="create">create</button>
    </nav>
    <article>
      <dl class="tasks"></dl>
    </article>
  </body>
</html>